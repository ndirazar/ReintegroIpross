{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from 'react';\nimport { Box, Container, Grid, IconButton, Link, makeStyles, Typography } from '@material-ui/core';\nimport ReceiptIcon from '@material-ui/icons/Receipt';\nimport { ACTIONS, PRESTACIONES, SOLICITUDES } from '../../labels';\nimport Table from '../common/Table';\nimport { Edit } from '@material-ui/icons';\nimport { getUser, strToDate } from '../common/helpers';\nimport { format } from 'date-fns';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    detail: {\n      backgroundColor: '#eae8e8',\n      paddingBottom: '15px'\n    },\n    container: {\n      margin: '0 15px',\n      width: '100%',\n      maxWidth: '100%'\n    }\n  };\n});\nexport default function SolicitudesSummary(_ref) {\n  var _solicitud$afiliado2, _SOLICITUDES$optionsT, _solicitud$afiliado3;\n\n  var solicitud = _ref.solicitud,\n      prestaciones = _ref.prestaciones,\n      header = _ref.header,\n      step = _ref.step,\n      onEditPrestacion = _ref.onEditPrestacion,\n      form = _ref.form;\n\n  // const [factura, setFactura] = useState(null);\n  var _useState = useState(''),\n      delegacion = _useState[0],\n      setDelegacion = _useState[1];\n\n  var _useState2 = useState(''),\n      estadoActual = _useState2[0],\n      setEstadoActual = _useState2[1];\n\n  var _useState3 = useState(prestaciones),\n      currentPrestaciones = _useState3[0],\n      setCurrentPrestaciones = _useState3[1];\n\n  var classes = useStyles();\n  var filesUrl = process.env.NEXT_PUBLIC_API.substring(0, process.env.NEXT_PUBLIC_API.length - 1);\n\n  var _useState4 = useState([]),\n      actions = _useState4[0],\n      setActions = _useState4[1];\n\n  var user = getUser();\n  var renders = {\n    factura: function factura(rowData) {\n      var _rowData$solicitud, _rowData$solicitud$fa;\n\n      if (rowData !== null && rowData !== void 0 && (_rowData$solicitud = rowData.solicitud) !== null && _rowData$solicitud !== void 0 && (_rowData$solicitud$fa = _rowData$solicitud.factura) !== null && _rowData$solicitud$fa !== void 0 && _rowData$solicitud$fa.archivo) {\n        var _rowData$solicitud2, _rowData$solicitud2$f;\n\n        return /*#__PURE__*/_jsx(Link, {\n          href: \"\".concat(filesUrl).concat(rowData === null || rowData === void 0 ? void 0 : (_rowData$solicitud2 = rowData.solicitud) === null || _rowData$solicitud2 === void 0 ? void 0 : (_rowData$solicitud2$f = _rowData$solicitud2.factura) === null || _rowData$solicitud2$f === void 0 ? void 0 : _rowData$solicitud2$f.archivo),\n          target: \"_blank\",\n          children: /*#__PURE__*/_jsx(IconButton, {\n            color: \"primary\",\n            \"aria-label\": \"factura\",\n            component: \"span\",\n            children: /*#__PURE__*/_jsx(ReceiptIcon, {})\n          })\n        });\n      } // Loaded file in input.\n\n\n      return /*#__PURE__*/_jsx(IconButton, {\n        color: \"primary\",\n        \"aria-label\": \"factura\",\n        component: \"span\",\n        onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var _form$solicitud;\n\n          var factura;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  factura = form === null || form === void 0 ? void 0 : (_form$solicitud = form.solicitud) === null || _form$solicitud === void 0 ? void 0 : _form$solicitud.factura[0];\n\n                  if (factura) {\n                    _context.next = 3;\n                    break;\n                  }\n\n                  return _context.abrupt(\"return\", false);\n\n                case 3:\n                  factura.arrayBuffer().then(function (arrayBuffer) {\n                    var blob = new Blob([new Uint8Array(arrayBuffer)], {\n                      type: factura.type\n                    });\n                    var element = document.createElement('a');\n                    element.href = URL.createObjectURL(blob);\n                    element.download = 'factura';\n                    document.body.appendChild(element);\n                    element.click();\n                  });\n\n                case 4:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        })),\n        children: /*#__PURE__*/_jsx(ReceiptIcon, {})\n      });\n    },\n    adjuntos: function adjuntos(rowData) {\n      var _rowData$adjuntos;\n\n      return (_rowData$adjuntos = rowData.adjuntos) === null || _rowData$adjuntos === void 0 ? void 0 : _rowData$adjuntos.map(function (adj, i) {\n        return /*#__PURE__*/_jsx(Link, {\n          href: \"\".concat(filesUrl).concat(adj.archivo),\n          target: \"_blank\",\n          children: /*#__PURE__*/_jsx(IconButton, {\n            color: \"primary\",\n            \"aria-label\": \"factura\",\n            component: \"span\",\n            children: /*#__PURE__*/_jsx(ReceiptIcon, {})\n          })\n        });\n      });\n    },\n    cud: function cud(rowData) {\n      var _solicitud$afiliado;\n\n      return (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'Si' || (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'true' ? solicitud === null || solicitud === void 0 ? void 0 : (_solicitud$afiliado = solicitud.afiliado) === null || _solicitud$afiliado === void 0 ? void 0 : _solicitud$afiliado.cud : '';\n    },\n    discapacitado: function discapacitado(rowData) {\n      return (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'Si' || (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'true' ? 'Si' : 'No';\n    },\n    fechaPractica: function fechaPractica(rowData) {\n      return format(strToDate(rowData.fechaPractica), 'dd/MM/yyyy');\n    },\n    fechaPracticaHasta: function fechaPracticaHasta(rowData) {\n      return rowData.fechaPracticaHasta ? format(strToDate(rowData.fechaPracticaHasta), 'dd/MM/yyyy') : '';\n    }\n  };\n  useEffect(function () {\n    var _user$delegaciones;\n\n    var del = user === null || user === void 0 ? void 0 : (_user$delegaciones = user.delegaciones) === null || _user$delegaciones === void 0 ? void 0 : _user$delegaciones.find(function (d) {\n      return d.id === (solicitud === null || solicitud === void 0 ? void 0 : solicitud.delegacion);\n    });\n    setDelegacion(del === null || del === void 0 ? void 0 : del.nombre);\n    var estado = SOLICITUDES.optionsEstadoActual.find(function (e) {\n      return e.value === (solicitud === null || solicitud === void 0 ? void 0 : solicitud.estadoActual);\n    });\n    setEstadoActual(estado === null || estado === void 0 ? void 0 : estado.label);\n\n    if (onEditPrestacion) {\n      setActions([{\n        icon: function icon() {\n          return /*#__PURE__*/_jsx(Edit, {});\n        },\n        tooltip: ACTIONS.update(SOLICITUDES.editPrestaciones),\n        onClick: function onClick(event, rowData) {\n          handleEditPrestacion(rowData);\n        }\n      }]);\n    }\n  }, [solicitud]);\n\n  var handleEditPrestacion = function handleEditPrestacion(rowData) {\n    onEditPrestacion && onEditPrestacion(rowData);\n  };\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    className: classes.detail,\n    children: /*#__PURE__*/_jsxs(Container, {\n      className: classes.container,\n      children: [solicitud && header && /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsxs(Box, {\n          children: [/*#__PURE__*/_jsx(Typography, {\n            variant: \"h5\",\n            gutterBottom: true,\n            children: step.title\n          }), /*#__PURE__*/_jsx(Typography, {\n            variant: \"subtitle1\",\n            gutterBottom: true,\n            children: step.description\n          })]\n        }), /*#__PURE__*/_jsxs(Grid, {\n          container: true,\n          spacing: 3,\n          children: [/*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.delegacionNombre\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: delegacion\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields['afiliado.codigo']\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: (_solicitud$afiliado2 = solicitud.afiliado) === null || _solicitud$afiliado2 === void 0 ? void 0 : _solicitud$afiliado2.codigo\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.estadoActual\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: estadoActual\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.fechaAlta\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: solicitud.fechaAlta ? format(new Date(solicitud.fechaAlta), 'dd/MM/yyyy') : ''\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.tipo\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: (_SOLICITUDES$optionsT = SOLICITUDES.optionsType.find(function (e) {\n                return e.value === (solicitud === null || solicitud === void 0 ? void 0 : solicitud.tipo);\n              })) === null || _SOLICITUDES$optionsT === void 0 ? void 0 : _SOLICITUDES$optionsT.label\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.discapacitado\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'true' ? \"Si - \".concat(solicitud === null || solicitud === void 0 ? void 0 : (_solicitud$afiliado3 = solicitud.afiliado) === null || _solicitud$afiliado3 === void 0 ? void 0 : _solicitud$afiliado3.cud) : 'No'\n            })]\n          })]\n        })]\n      }), currentPrestaciones && /*#__PURE__*/_jsx(Table, {\n        columns: Object.keys(PRESTACIONES.cols).map(function (key) {\n          var _ref3, _renders$key;\n\n          return {\n            title: PRESTACIONES.cols[key],\n            field: key,\n            render: (_ref3 = (_renders$key = renders[key]) !== null && _renders$key !== void 0 ? _renders$key : PRESTACIONES.renders[key]) !== null && _ref3 !== void 0 ? _ref3 : null\n          };\n        }),\n        totalCount: currentPrestaciones.length,\n        data: currentPrestaciones,\n        title: PRESTACIONES.name,\n        options: {\n          search: false\n        },\n        pageSize: currentPrestaciones.length,\n        paging: false,\n        actions: actions\n      })]\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}