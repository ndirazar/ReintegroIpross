{"ast":null,"code":"import _defineProperty from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/reintegros/reintegros-frontend/components/afiliados/AfiliadosSearch.tsx\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport { FieldType } from '../builder/FormField';\nimport { SOLICITUDES } from '../../labels';\nimport { Grid, Typography, makeStyles } from '@material-ui/core';\nimport FieldRender from '../builder/FieldRender';\nimport { send } from '../api-call/service';\nimport { IconButton } from '@material-ui/core';\nimport { Edit } from '@material-ui/icons';\nimport { isUserAdmin } from '../common/helpers';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    afiliadoField: {\n      display: 'None'\n    },\n    afiliadoSearch: {\n      paddingLeft: '10px'\n    },\n    afiliadoDetail: {\n      '& h6': {\n        fontSize: '14px'\n      }\n    },\n    disabledField: {\n      padding: '20px 30px 0',\n      position: 'relative',\n      '& .MuiFormGroup-root': {\n        display: 'block'\n      }\n    },\n    cudField: {\n      marginTop: '15px',\n      '& input': {\n        '&::-webkit-outer-spin-button, &::-webkit-inner-spin-button': {\n          '-webkit-appearance': 'none',\n          margin: 0\n        }\n      }\n    },\n    cudEditBtn: {\n      padding: '8px',\n      right: '9px'\n    },\n    cudEditIcon: {\n      fontSize: '.8em'\n    },\n    cudError: {\n      fontSize: '14px'\n    }\n  };\n});\nexport default function Afiliados(_ref) {\n  _s();\n\n  var _formContent$solicitu, _formContent$solicitu2, _formContent$solicitu3;\n\n  var form = _ref.form,\n      onSelect = _ref.onSelect,\n      formContent = _ref.formContent;\n\n  var _useState = useState(''),\n      afiliadoError = _useState[0],\n      setAfiliadoError = _useState[1];\n\n  var _useState2 = useState((formContent === null || formContent === void 0 ? void 0 : (_formContent$solicitu = formContent.solicitud) === null || _formContent$solicitu === void 0 ? void 0 : _formContent$solicitu.afiliado) || null),\n      afiliado = _useState2[0],\n      setAfiliado = _useState2[1];\n\n  var classes = useStyles();\n\n  var _useState3 = useState(null),\n      cudError = _useState3[0],\n      setCudError = _useState3[1];\n\n  var _useState4 = useState(true),\n      cudDisabled = _useState4[0],\n      setCudDisabled = _useState4[1];\n\n  var _useState5 = useState(formContent === null || formContent === void 0 ? void 0 : (_formContent$solicitu2 = formContent.solicitud) === null || _formContent$solicitu2 === void 0 ? void 0 : _formContent$solicitu2.discapacitado),\n      cudVisible = _useState5[0],\n      setCudVisible = _useState5[1];\n\n  var searchConfig = {\n    name: 'numeroAfiliado',\n    type: FieldType.string,\n    label: 'Nro. Afiliado',\n    help: 'Formato xx-xxxxxxxx/xx',\n    onChange: function () {\n      var _onChange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, f) {\n        var _afiliadoTemp;\n\n        var regex, isValid, afiliadoTemp, val, _error$response, _error$response$data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                regex = /^[0-9]{2}-[0-9]{8}\\/[0-9]{2}$/;\n                isValid = value.match(regex);\n                afiliadoTemp = null;\n                setAfiliadoError('');\n                setAfiliado(null);\n\n                if (!isValid) {\n                  _context.next = 17;\n                  break;\n                }\n\n                _context.prev = 6;\n                _context.next = 9;\n                return send({\n                  url: \"api/verificar/afiliado\",\n                  data: {\n                    afiliado: value\n                  },\n                  method: 'POST',\n                  headers: {\n                    'Content-Type': 'application/json'\n                  }\n                });\n\n              case 9:\n                val = _context.sent;\n\n                if (val.data.afiliado) {\n                  afiliadoTemp = val.data.afiliado;\n                } else {\n                  afiliadoTemp = null;\n                  setAfiliadoError('Un error');\n                }\n\n                _context.next = 17;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](6);\n                afiliadoTemp = null;\n\n                if ((_error$response = _context.t0.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n                  setAfiliadoError(_context.t0.response.data.message);\n                } else {\n                  setAfiliadoError('Error consultando afiliado');\n                }\n\n              case 17:\n                form.setValue('afiliado', afiliadoTemp);\n                form.setValue('cud', ((_afiliadoTemp = afiliadoTemp) === null || _afiliadoTemp === void 0 ? void 0 : _afiliadoTemp.cud) || '');\n                setAfiliado(afiliadoTemp);\n                onSelect(afiliadoTemp);\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[6, 13]]);\n      }));\n\n      function onChange(_x, _x2) {\n        return _onChange.apply(this, arguments);\n      }\n\n      return onChange;\n    }(),\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    }\n  };\n  var afiliadoField = {\n    name: 'afiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    },\n    disable: true\n  };\n  var cudField = {\n    name: 'cud',\n    type: FieldType[\"int\"],\n    label: SOLICITUDES.fields['cud'],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: false,\n      max: 9999999999\n    },\n    disabled: cudDisabled,\n    onBlur: function () {\n      var _onBlur = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value, form) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                setCudError(false);\n\n                if (value) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", false);\n\n              case 3:\n                if (!(parseInt(value) > cudField.rules.max)) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                setCudError('El valor no ser mayor a ' + cudField.rules.max);\n                return _context2.abrupt(\"return\", false);\n\n              case 6:\n                updateCud(value);\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function onBlur(_x3, _x4) {\n        return _onBlur.apply(this, arguments);\n      }\n\n      return onBlur;\n    }(),\n    suffix: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: cudDisabled && isUserAdmin() && /*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: function onClick() {\n          setCudDisabled(false);\n        },\n        color: \"default\",\n        className: classes.cudEditBtn,\n        children: /*#__PURE__*/_jsxDEV(Edit, {\n          className: classes.cudEditIcon\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 11\n      }, this)\n    }, void 0, false)\n  };\n  var isDisabledCheck = {\n    name: 'discapacitado',\n    type: FieldType.radio,\n    label: SOLICITUDES.fields['discapacitado'],\n    options: [{\n      label: 'Si',\n      value: 'true'\n    }, {\n      label: 'No',\n      value: 'false'\n    }],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: false\n    },\n    onChange: function onChange(val, form) {\n      setCudVisible(val);\n      onSelect(afiliado);\n    }\n  };\n  useEffect(function () {\n    if (isUserAdmin()) {\n      setCudDisabled(isUserAdmin() && afiliado && afiliado.cud ? true : false);\n    }\n  }, [afiliado, setCudDisabled]);\n\n  var updateCud = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(cud) {\n      var val, _error$response2, _error$response2$data, errorMsg;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setCudError(null);\n              _context3.prev = 1;\n              _context3.next = 4;\n              return send({\n                url: \"api/verificar/cud\",\n                data: {\n                  afiliado: afiliado === null || afiliado === void 0 ? void 0 : afiliado.id,\n                  cud: cud\n                },\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n\n            case 4:\n              val = _context3.sent;\n              setCudDisabled(true);\n              onSelect(_objectSpread(_objectSpread({}, afiliado), {}, {\n                cud: cud\n              }));\n              _context3.next = 13;\n              break;\n\n            case 9:\n              _context3.prev = 9;\n              _context3.t0 = _context3[\"catch\"](1);\n              errorMsg = ((_error$response2 = _context3.t0.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'Error validando CUD';\n              setCudError(errorMsg);\n\n            case 13:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 9]]);\n    }));\n\n    return function updateCud(_x5) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.afiliadoSearch,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: searchConfig,\n            form: form,\n            data: {\n              numeroAfiliado: afiliado === null || afiliado === void 0 ? void 0 : afiliado.numeroAfiliado\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.afiliadoField,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: afiliadoField,\n            form: form,\n            data: {\n              afiliado: afiliado\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.afiliadoDetail,\n          children: [afiliado && /*#__PURE__*/_jsxDEV(FieldRender, {\n            form: form,\n            field: {\n              name: 'afiliadoNombre',\n              type: FieldType.string,\n              label: 'Afiliado',\n              disabled: true\n            },\n            data: {\n              afiliadoNombre: afiliado && \"\".concat(afiliado === null || afiliado === void 0 ? void 0 : afiliado.nombre, \" \").concat(afiliado === null || afiliado === void 0 ? void 0 : afiliado.apellido)\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 15\n          }, this), afiliadoError && /*#__PURE__*/_jsxDEV(Typography, {\n            component: \"h6\",\n            color: \"error\",\n            children: afiliadoError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.disabledField,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: isDisabledCheck,\n            form: form,\n            data: {\n              discapacitado: formContent === null || formContent === void 0 ? void 0 : (_formContent$solicitu3 = formContent.solicitud) === null || _formContent$solicitu3 === void 0 ? void 0 : _formContent$solicitu3.discapacitado\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this), cudVisible === 'true' && /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.cudField,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: cudField,\n            form: form,\n            data: {\n              cud: afiliado === null || afiliado === void 0 ? void 0 : afiliado.cud\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 13\n        }, this), cudError && /*#__PURE__*/_jsxDEV(Typography, {\n          component: \"h6\",\n          color: \"error\",\n          className: classes.cudError,\n          children: cudError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Afiliados, \"KiiHugEazajmJRivtFvmgcOKoBw=\", false, function () {\n  return [useStyles];\n});\n\n_c = Afiliados;\n\nvar _c;\n\n$RefreshReg$(_c, \"Afiliados\");","map":{"version":3,"sources":["/reintegros/reintegros-frontend/components/afiliados/AfiliadosSearch.tsx"],"names":["React","useEffect","useState","FieldType","SOLICITUDES","Grid","Typography","makeStyles","FieldRender","send","IconButton","Edit","isUserAdmin","useStyles","theme","afiliadoField","display","afiliadoSearch","paddingLeft","afiliadoDetail","fontSize","disabledField","padding","position","cudField","marginTop","margin","cudEditBtn","right","cudEditIcon","cudError","Afiliados","form","onSelect","formContent","afiliadoError","setAfiliadoError","solicitud","afiliado","setAfiliado","classes","setCudError","cudDisabled","setCudDisabled","discapacitado","cudVisible","setCudVisible","searchConfig","name","type","string","label","help","onChange","value","f","regex","isValid","match","afiliadoTemp","url","data","method","headers","val","response","message","setValue","cud","styling","columns","rules","required","fields","disable","max","disabled","onBlur","parseInt","updateCud","suffix","isDisabledCheck","radio","options","id","errorMsg","numeroAfiliado","afiliadoNombre","nombre","apellido"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { FieldType } from '../builder/FormField';\nimport { SOLICITUDES } from '../../labels';\nimport { Grid, Typography, makeStyles } from '@material-ui/core';\nimport FieldRender from '../builder/FieldRender';\nimport { send } from '../api-call/service';\nimport { IconButton } from '@material-ui/core';\nimport { Edit } from '@material-ui/icons';\nimport { isUserAdmin } from '../common/helpers';\n\nconst useStyles = makeStyles((theme) => ({\n  afiliadoField: {\n    display: 'None',\n  },\n  afiliadoSearch: {\n    paddingLeft: '10px',\n  },\n  afiliadoDetail: {\n    '& h6': {\n      fontSize: '14px',\n    },\n  },\n  disabledField: {\n    padding: '20px 30px 0',\n    position: 'relative',\n    '& .MuiFormGroup-root': {\n      display: 'block',\n    },\n  },\n  cudField: {\n    marginTop: '15px',\n    '& input': {\n      '&::-webkit-outer-spin-button, &::-webkit-inner-spin-button': {\n        '-webkit-appearance': 'none',\n        margin: 0,\n      },\n    },\n  },\n  cudEditBtn: {\n    padding: '8px',\n    right: '9px',\n  },\n  cudEditIcon: {\n    fontSize: '.8em',\n  },\n  cudError: {\n    fontSize: '14px',\n  },\n}));\n\nexport default function Afiliados({ form, onSelect, formContent }) {\n  const [afiliadoError, setAfiliadoError] = useState('');\n  const [afiliado, setAfiliado] = useState(formContent?.solicitud?.afiliado || null);\n  const classes = useStyles();\n  const [cudError, setCudError] = useState(null);\n  const [cudDisabled, setCudDisabled] = useState(true);\n  const [cudVisible, setCudVisible] = useState(formContent?.solicitud?.discapacitado);\n\n  const searchConfig = {\n    name: 'numeroAfiliado',\n    type: FieldType.string,\n    label: 'Nro. Afiliado',\n    help: 'Formato xx-xxxxxxxx/xx',\n    onChange: async (value, f) => {\n      const regex = /^[0-9]{2}-[0-9]{8}\\/[0-9]{2}$/;\n      const isValid = value.match(regex);\n      let afiliadoTemp = null;\n      setAfiliadoError('');\n      setAfiliado(null);\n      if (isValid) {\n        try {\n          const val = await send({\n            url: `api/verificar/afiliado`,\n            data: { afiliado: value },\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n          });\n          if (val.data.afiliado) {\n            afiliadoTemp = val.data.afiliado;\n          } else {\n            afiliadoTemp = null;\n            setAfiliadoError('Un error');\n          }\n        } catch (error) {\n          afiliadoTemp = null;\n          if (error.response?.data?.message) {\n            setAfiliadoError(error.response.data.message);\n          } else {\n            setAfiliadoError('Error consultando afiliado');\n          }\n        }\n      }\n      form.setValue('afiliado', afiliadoTemp);\n      form.setValue('cud', afiliadoTemp?.cud || '');\n      setAfiliado(afiliadoTemp);\n      onSelect(afiliadoTemp);\n    },\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: true,\n    },\n  };\n  const afiliadoField = {\n    name: 'afiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: true,\n    },\n    disable: true,\n  };\n  const cudField = {\n    name: 'cud',\n    type: FieldType.int,\n    label: SOLICITUDES.fields['cud'],\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: false,\n      max: 9999999999,\n    },\n    disabled: cudDisabled,\n    onBlur: async (value, form) => {\n      setCudError(false);\n      if (!value) {\n        return false;\n      }\n\n      if (parseInt(value) > cudField.rules.max) {\n        setCudError('El valor no ser mayor a ' + cudField.rules.max);\n        return false;\n      }\n\n      updateCud(value);\n    },\n    suffix: (\n      <>\n        {cudDisabled && isUserAdmin() && (\n          <IconButton\n            onClick={() => {\n              setCudDisabled(false);\n            }}\n            color=\"default\"\n            className={classes.cudEditBtn}\n          >\n            <Edit className={classes.cudEditIcon} />\n          </IconButton>\n        )}\n      </>\n    ),\n  };\n  const isDisabledCheck = {\n    name: 'discapacitado',\n    type: FieldType.radio,\n    label: SOLICITUDES.fields['discapacitado'],\n    options: [\n      { label: 'Si', value: 'true' },\n      { label: 'No', value: 'false' },\n    ],\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: false,\n    },\n    onChange: (val, form) => {\n      setCudVisible(val);\n      onSelect(afiliado);\n    },\n  };\n\n  useEffect(() => {\n    if (isUserAdmin()) {\n      setCudDisabled(isUserAdmin() && afiliado && afiliado.cud ? true : false);\n    }\n  }, [afiliado, setCudDisabled]);\n\n  const updateCud = async (cud) => {\n    setCudError(null);\n    try {\n      const val = await send({\n        url: `api/verificar/cud`,\n        data: { afiliado: afiliado?.id, cud: cud },\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n      setCudDisabled(true);\n      onSelect({ ...afiliado, cud: cud });\n    } catch (error) {\n      const errorMsg = error.response?.data?.message || 'Error validando CUD';\n      setCudError(errorMsg);\n    }\n  };\n\n  return (\n    <>\n      <Grid container spacing={2}>\n        <Grid item md={3}>\n          <div className={classes.afiliadoSearch}>\n            <FieldRender\n              field={searchConfig}\n              form={form}\n              data={{ numeroAfiliado: afiliado?.numeroAfiliado }}\n            />\n          </div>\n        </Grid>\n        <Grid item md={3}>\n          <div className={classes.afiliadoField}>\n            <FieldRender field={afiliadoField} form={form} data={{ afiliado: afiliado }} />\n          </div>\n          <div className={classes.afiliadoDetail}>\n            {afiliado && (\n              <FieldRender\n                form={form}\n                field={{\n                  name: 'afiliadoNombre',\n                  type: FieldType.string,\n                  label: 'Afiliado',\n                  disabled: true,\n                }}\n                data={{\n                  afiliadoNombre: afiliado && `${afiliado?.nombre} ${afiliado?.apellido}`,\n                }}\n              />\n            )}\n\n            {afiliadoError && (\n              <Typography component=\"h6\" color=\"error\">\n                {afiliadoError}\n              </Typography>\n            )}\n          </div>\n        </Grid>\n      </Grid>\n      <Grid container spacing={2}>\n        <Grid item md={3}>\n          <div className={classes.disabledField}>\n            <FieldRender\n              field={isDisabledCheck}\n              form={form}\n              data={{ discapacitado: formContent?.solicitud?.discapacitado }}\n            />\n          </div>\n        </Grid>\n        {cudVisible === 'true' && (\n          <Grid item md={3}>\n            <div className={classes.cudField}>\n              <FieldRender field={cudField} form={form} data={{ cud: afiliado?.cud }} />\n            </div>\n            {cudError && (\n              <Typography component=\"h6\" color=\"error\" className={classes.cudError}>\n                {cudError}\n              </Typography>\n            )}\n          </Grid>\n        )}\n      </Grid>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}