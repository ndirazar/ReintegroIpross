{"ast":null,"code":"import _regeneratorRuntime from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState } from 'react';\nimport { FieldType } from '../builder/FormField';\nimport { SOLICITUDES } from '../../labels';\nimport { Grid, Typography, makeStyles } from '@material-ui/core';\nimport FieldRender from '../builder/FieldRender';\nimport { send } from '../api-call/service';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    afiliadoField: {\n      display: 'None'\n    },\n    afiliadoSearch: {\n      paddingLeft: '10px'\n    },\n    afiliadoDetail: {\n      paddingTop: '15px',\n      '& h6': {\n        fontSize: '14px'\n      }\n    }\n  };\n});\nexport default function Afiliados(_ref) {\n  var form = _ref.form,\n      onSelect = _ref.onSelect;\n\n  var _useState = useState(null),\n      afiliadoError = _useState[0],\n      setAfiliadoError = _useState[1];\n\n  var _useState2 = useState(null),\n      afiliado = _useState2[0],\n      setAfiliado = _useState2[1];\n\n  var classes = useStyles();\n\n  var showAfiliado = function showAfiliado() {\n    return afiliadoError ? /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(Typography, {\n        component: \"h6\",\n        color: \"error\",\n        children: afiliadoError\n      })\n    }) : afiliado && /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsxs(Typography, {\n        component: \"h6\",\n        children: [/*#__PURE__*/_jsx(\"strong\", {\n          children: \"Nombre: \"\n        }), \" \", afiliado.nombre, \" \", afiliado.apellido]\n      }), /*#__PURE__*/_jsxs(Typography, {\n        component: \"h6\",\n        children: [/*#__PURE__*/_jsx(\"strong\", {\n          children: \"Cuit/Cuil: \"\n        }), afiliado.cuitCuil, /*#__PURE__*/_jsx(\"strong\", {\n          children: \" Cbu: \"\n        }), afiliado.cbu]\n      })]\n    });\n  };\n\n  var searchConfig = {\n    name: 'numeroAfiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    onChange: function () {\n      var _onChange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, f) {\n        var regex, isValid, val, _error$response, _error$response$data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                regex = /^[0-9]{2}-[0-9]{8}\\/[0-9]{2}$/;\n                isValid = value.match(regex);\n                setAfiliadoError(null);\n\n                if (!isValid) {\n                  _context.next = 18;\n                  break;\n                }\n\n                _context.prev = 4;\n                _context.next = 7;\n                return send({\n                  url: \"api/verificar/afiliado\",\n                  data: {\n                    afiliado: value\n                  },\n                  method: 'POST',\n                  headers: {\n                    'Content-Type': 'application/json'\n                  }\n                });\n\n              case 7:\n                val = _context.sent;\n\n                if (val.data.afiliado) {\n                  form.setValue('afiliado', val.data.afiliado);\n                  setAfiliado(val.data.afiliado);\n                  onSelect(val.data.afiliado);\n                } else {\n                  setAfiliado(null);\n                  setAfiliadoError('Un error');\n                }\n\n                _context.next = 16;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](4);\n                console.log(_context.t0);\n                setAfiliado(null);\n\n                if ((_error$response = _context.t0.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n                  setAfiliadoError(_context.t0.response.data.message);\n                } else {\n                  setAfiliadoError('Error consultando afiliado');\n                }\n\n              case 16:\n                _context.next = 19;\n                break;\n\n              case 18:\n                setAfiliado(null);\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[4, 11]]);\n      }));\n\n      function onChange(_x, _x2) {\n        return _onChange.apply(this, arguments);\n      }\n\n      return onChange;\n    }(),\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    }\n  };\n  var afiliadoField = {\n    name: 'afiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    },\n    disable: true\n  };\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsx(Grid, {\n        item: true,\n        md: 3,\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: classes.afiliadoSearch,\n          children: /*#__PURE__*/_jsx(FieldRender, {\n            field: searchConfig,\n            form: form,\n            data: []\n          })\n        })\n      }), /*#__PURE__*/_jsxs(Grid, {\n        item: true,\n        md: 9,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: classes.afiliadoField,\n          children: /*#__PURE__*/_jsx(FieldRender, {\n            field: afiliadoField,\n            form: form,\n            data: []\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: classes.afiliadoDetail,\n          children: showAfiliado()\n        })]\n      })]\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}