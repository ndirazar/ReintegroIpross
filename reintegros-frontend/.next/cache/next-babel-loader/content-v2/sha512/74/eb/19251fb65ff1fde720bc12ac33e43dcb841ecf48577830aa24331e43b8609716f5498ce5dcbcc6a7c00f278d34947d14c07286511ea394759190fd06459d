{"ast":null,"code":"import _defineProperty from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { MenuItem, Select, Switch, Typography } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport { USERS } from '../../labels';\nimport SelectGroups from './SelectGroups';\nimport SelectCapitulos from './SelectCapitulos';\nimport SelectDelegacion from './SelectDelegacion';\nimport AutorenewIcon from '@material-ui/icons/Autorenew';\nimport dynamic from 'next/dynamic';\nimport { isUserAdmin, userHasRole } from '../common/helpers';\nexport default function UsersList(_ref) {\n  var data = _ref.data,\n      _delegaciones = _ref.delegaciones,\n      grupos = _ref.grupos,\n      _capitulos = _ref.capitulos,\n      onUserDeactivate = _ref.onUserDeactivate,\n      onhandleSetGroups = _ref.onhandleSetGroups,\n      onhandleSetCapitulos = _ref.onhandleSetCapitulos,\n      onhandleSetDelegaciones = _ref.onhandleSetDelegaciones,\n      onhandleSetDelegacionPrincipal = _ref.onhandleSetDelegacionPrincipal,\n      onSync = _ref.onSync,\n      onPaginationChange = _ref.onPaginationChange,\n      onFilter = _ref.onFilter;\n\n  var onSetUserGroups = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(groupsSelected, userId) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (grupos !== undefined) {\n                onhandleSetGroups(groupsSelected, userId);\n              }\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onSetUserGroups(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onSetDelegaciones = function onSetDelegaciones(delegacionesSelected, userId) {\n    var result = [];\n\n    if (_delegaciones !== undefined) {\n      delegacionesSelected.forEach(function (delegacionSelected) {\n        var delegacion = _delegaciones.results.find(function (delegacion) {\n          return delegacion.nombre === delegacionSelected;\n        });\n\n        result.push(delegacion.id);\n      });\n      onhandleSetDelegaciones(result, userId);\n    }\n  };\n\n  var onSetDelegacionPrincipal = function onSetDelegacionPrincipal(delegacionId, userId) {\n    onhandleSetDelegacionPrincipal(delegacionId, userId);\n  };\n\n  var onSetUserCapitulos = function onSetUserCapitulos(capitulosSelected, userId) {\n    if (_capitulos !== undefined) {\n      onhandleSetCapitulos(capitulosSelected, userId);\n    }\n  };\n\n  var dynamicRenders = {\n    is_active: function is_active(rowData) {\n      if (isUserAdmin()) {\n        return /*#__PURE__*/_jsx(Switch, {\n          checked: rowData.is_active === true,\n          onChange: function onChange() {\n            return onUserDeactivate(rowData === null || rowData === void 0 ? void 0 : rowData.id, rowData.is_active);\n          },\n          name: \"active-switch\",\n          color: \"primary\"\n        });\n      } else {\n        return rowData.is_active ? /*#__PURE__*/_jsx(Typography, {\n          children: \"Si\"\n        }) : /*#__PURE__*/_jsx(Typography, {\n          children: \"No\"\n        });\n      }\n    },\n    groups: function groups(rowData) {\n      if (isUserAdmin()) {\n        return /*#__PURE__*/_jsx(SelectGroups, {\n          grupos: grupos,\n          rowData: rowData,\n          onSetUserGroups: onSetUserGroups\n        });\n      } else {\n        // TO DO: ver que elemento UI usar\n        var roles = [];\n        rowData.groups.forEach(function (group) {\n          roles.push(group.name);\n          roles.push('-');\n        });\n        roles.pop();\n        return roles;\n      }\n    },\n    delegaciones: function delegaciones(rowData) {\n      if (rowData.casaCentral) {\n        return /*#__PURE__*/_jsx(Typography, {\n          children: \"Casa central\"\n        });\n      }\n\n      if (isUserAdmin()) {\n        return /*#__PURE__*/_jsx(SelectDelegacion, {\n          delegaciones: _delegaciones,\n          rowData: rowData,\n          onSetDelegaciones: onSetDelegaciones\n        });\n      } else {\n        // TO DO: ver que elemento UI usar\n        var delegaciones_tabla = [];\n        rowData.delegaciones.forEach(function (delegacion) {\n          delegaciones_tabla.push(delegacion.nombre);\n          delegaciones_tabla.push('-');\n        });\n        delegaciones_tabla.pop();\n        return delegaciones_tabla;\n      }\n    },\n    delegacionPrincipal: function delegacionPrincipal(rowData) {\n      if (isUserAdmin()) {\n        var _rowData$delegacionPr, _rowData$delegacionPr2;\n\n        return /*#__PURE__*/_jsx(Select, {\n          onChange: function onChange(event) {\n            onSetDelegacionPrincipal(event.target.value, rowData.id);\n          },\n          value: (_rowData$delegacionPr = (_rowData$delegacionPr2 = rowData.delegacionPrincipal) === null || _rowData$delegacionPr2 === void 0 ? void 0 : _rowData$delegacionPr2.id) !== null && _rowData$delegacionPr !== void 0 ? _rowData$delegacionPr : '',\n          children: rowData.delegaciones.map(function (d) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: d.id,\n              children: d.nombre\n            }, d.id);\n          })\n        });\n      } else {\n        return rowData.delegacionPrincipal ? /*#__PURE__*/_jsx(Typography, {\n          children: rowData.delegacionPrincipal.nombre\n        }) : /*#__PURE__*/_jsx(Typography, {});\n      }\n    },\n    capitulos: function capitulos(rowData) {\n      if (isUserAdmin() && (userHasRole(rowData, 'AuditoriaAdministrativa') || userHasRole(rowData, 'AuditoriaMedica') || userHasRole(rowData, 'AuditoriaCentral'))) {\n        return /*#__PURE__*/_jsx(SelectCapitulos, {\n          capitulos: _capitulos,\n          rowData: rowData,\n          onSetUserCapitulos: onSetUserCapitulos\n        });\n      } else {\n        // TO DO: ver que elemento UI usar\n        var caps = [];\n        rowData.capitulos.forEach(function (cap) {\n          caps.push(\"\".concat(cap.capitulo, \". \").concat(cap.descripcion));\n          caps.push('-');\n        });\n        caps.pop();\n        return caps;\n      }\n    }\n  };\n  var columns = Object.keys(USERS.fields).map(function (key) {\n    var _ref3, _dynamicRenders$key;\n\n    return {\n      title: USERS.fields[key],\n      field: key,\n      render: (_ref3 = (_dynamicRenders$key = dynamicRenders[key]) !== null && _dynamicRenders$key !== void 0 ? _dynamicRenders$key : USERS.renders[key]) !== null && _ref3 !== void 0 ? _ref3 : null\n    };\n  });\n\n  var getUserActions = function getUserActions() {\n    var actions = [];\n\n    if (isUserAdmin()) {\n      actions = [{\n        label: USERS.customActions.sync,\n        onClick: onSync,\n        icon: /*#__PURE__*/_jsx(AutorenewIcon, {})\n      }];\n    }\n\n    return actions;\n  };\n\n  var _useState = useState({\n    page: 1,\n    pageSize: 20\n  }),\n      pagination = _useState[0],\n      setPagination = _useState[1];\n\n  var reloadPagination = function reloadPagination(pagData) {\n    setPagination(pagData);\n    onPaginationChange(_objectSpread(_objectSpread({}, pagination), pagData));\n  };\n\n  var Table = dynamic(function () {\n    return import('../common/Table');\n  }, {\n    loadableGenerated: {\n      webpack: function webpack() {\n        return [require.resolveWeak('../common/Table')];\n      },\n      modules: ['../common/Table']\n    }\n  });\n  return /*#__PURE__*/_jsx(Table, {\n    columns: columns,\n    totalCount: data === null || data === void 0 ? void 0 : data.count,\n    data: data === null || data === void 0 ? void 0 : data.results,\n    title: USERS.name,\n    headerActions: getUserActions(),\n    options: {\n      search: false\n    },\n    pagination: {\n      page: pagination.page - 1,\n      pageSize: pagination.pageSize\n    },\n    onPageChange: function onPageChange(page, pageSize) {\n      reloadPagination(_objectSpread(_objectSpread({}, pagination), {}, {\n        page: page + 1,\n        pageSize: pageSize\n      }));\n    },\n    onChangeRowsPerPage: function onChangeRowsPerPage(pageSize) {\n      reloadPagination(_objectSpread(_objectSpread({}, pagination), {}, {\n        pageSize: pageSize\n      }));\n    },\n    onFilterClick: onFilter\n  });\n}","map":null,"metadata":{},"sourceType":"module"}