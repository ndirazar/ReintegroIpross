{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/reintegros/reintegros-frontend/components/afiliados/AfiliadosSearch.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from 'react';\nimport { FieldType } from '../builder/FormField';\nimport { SOLICITUDES } from '../../labels';\nimport { Grid, Typography, makeStyles } from '@material-ui/core';\nimport FieldRender from '../builder/FieldRender';\nimport { send } from '../api-call/service';\nimport { IconButton } from '@material-ui/core';\nimport { Edit } from '@material-ui/icons';\nimport { isUserAdmin } from '../common/helpers';\nconst useStyles = makeStyles(theme => ({\n  afiliadoField: {\n    display: 'None'\n  },\n  afiliadoSearch: {\n    paddingLeft: '10px'\n  },\n  afiliadoDetail: {\n    '& h6': {\n      fontSize: '14px'\n    }\n  },\n  disabledField: {\n    padding: '20px 30px 0',\n    position: 'relative',\n    '& .MuiFormGroup-root': {\n      display: 'block'\n    }\n  },\n  cudField: {\n    marginTop: '15px',\n    '& input': {\n      '&::-webkit-outer-spin-button, &::-webkit-inner-spin-button': {\n        '-webkit-appearance': 'none',\n        margin: 0\n      }\n    }\n  },\n  cudEditBtn: {\n    padding: '8px',\n    right: '9px'\n  },\n  cudEditIcon: {\n    fontSize: '.8em'\n  },\n  cudError: {\n    fontSize: '14px'\n  }\n}));\nexport default function Afiliados({\n  form,\n  onSelect,\n  formContent\n}) {\n  var _formContent$solicitu, _formContent$solicitu2, _formContent$solicitu3;\n\n  const {\n    0: afiliadoError,\n    1: setAfiliadoError\n  } = useState('');\n  const {\n    0: afiliado,\n    1: setAfiliado\n  } = useState((formContent === null || formContent === void 0 ? void 0 : (_formContent$solicitu = formContent.solicitud) === null || _formContent$solicitu === void 0 ? void 0 : _formContent$solicitu.afiliado) || null);\n  const classes = useStyles();\n  const {\n    0: cudError,\n    1: setCudError\n  } = useState(null);\n  const {\n    0: cudDisabled,\n    1: setCudDisabled\n  } = useState(true);\n  const {\n    0: cudVisible,\n    1: setCudVisible\n  } = useState(formContent === null || formContent === void 0 ? void 0 : (_formContent$solicitu2 = formContent.solicitud) === null || _formContent$solicitu2 === void 0 ? void 0 : _formContent$solicitu2.discapacitado);\n  const searchConfig = {\n    name: 'numeroAfiliado',\n    type: FieldType.string,\n    label: 'Nro. Afiliado',\n    help: 'Formato xx-xxxxxxxx/xx',\n    onChange: async (value, f) => {\n      var _afiliadoTemp;\n\n      const regex = /^[0-9]{2}-[0-9]{8}\\/[0-9]{2}$/;\n      const isValid = value.match(regex);\n      let afiliadoTemp = null;\n      setAfiliadoError('');\n      setAfiliado(null);\n\n      if (isValid) {\n        try {\n          const val = await send({\n            url: `api/verificar/afiliado`,\n            data: {\n              afiliado: value\n            },\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          });\n\n          if (val.data.afiliado) {\n            afiliadoTemp = val.data.afiliado;\n          } else {\n            afiliadoTemp = null;\n            setAfiliadoError('Un error');\n          }\n        } catch (error) {\n          var _error$response, _error$response$data;\n\n          afiliadoTemp = null;\n\n          if ((_error$response = error.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n            setAfiliadoError(error.response.data.message);\n          } else {\n            setAfiliadoError('Error consultando afiliado');\n          }\n        }\n      }\n\n      form.setValue('afiliado', afiliadoTemp);\n      form.setValue('cud', ((_afiliadoTemp = afiliadoTemp) === null || _afiliadoTemp === void 0 ? void 0 : _afiliadoTemp.cud) || '');\n      setAfiliado(afiliadoTemp);\n      onSelect(afiliadoTemp);\n    },\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    }\n  };\n  const afiliadoField = {\n    name: 'afiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    },\n    disable: true\n  };\n  const cudField = {\n    name: 'cud',\n    type: FieldType.int,\n    label: SOLICITUDES.fields['cud'],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: false,\n      max: 9999999999\n    },\n    disabled: cudDisabled,\n    onBlur: async (value, form) => {\n      setCudError(false);\n\n      if (!value) {\n        return false;\n      }\n\n      if (parseInt(value) > cudField.rules.max) {\n        setCudError('El valor no ser mayor a ' + cudField.rules.max);\n        return false;\n      }\n\n      updateCud(value);\n    },\n    suffix: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: cudDisabled && isUserAdmin() && /*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: () => {\n          setCudDisabled(false);\n        },\n        color: \"default\",\n        className: classes.cudEditBtn,\n        children: /*#__PURE__*/_jsxDEV(Edit, {\n          className: classes.cudEditIcon\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 11\n      }, this)\n    }, void 0, false)\n  };\n  const isDisabledCheck = {\n    name: 'discapacitado',\n    type: FieldType.radio,\n    label: SOLICITUDES.fields['discapacitado'],\n    options: [{\n      label: 'Si',\n      value: 'true'\n    }, {\n      label: 'No',\n      value: 'false'\n    }],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: false\n    },\n    onChange: (val, form) => {\n      setCudVisible(val);\n      onSelect(afiliado);\n    }\n  };\n  useEffect(() => {\n    if (isUserAdmin()) {\n      setCudDisabled(isUserAdmin() && afiliado && afiliado.cud ? true : false);\n    }\n  }, [afiliado, setCudDisabled]);\n\n  const updateCud = async cud => {\n    setCudError(null);\n\n    try {\n      const val = await send({\n        url: `api/verificar/cud`,\n        data: {\n          afiliado: afiliado === null || afiliado === void 0 ? void 0 : afiliado.id,\n          cud: cud\n        },\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      setCudDisabled(true);\n      onSelect(_objectSpread(_objectSpread({}, afiliado), {}, {\n        cud: cud\n      }));\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n\n      const errorMsg = ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'Error validando CUD';\n      setCudError(errorMsg);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.afiliadoSearch,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: searchConfig,\n            form: form,\n            data: {\n              numeroAfiliado: afiliado === null || afiliado === void 0 ? void 0 : afiliado.numeroAfiliado\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.afiliadoField,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: afiliadoField,\n            form: form,\n            data: {\n              afiliado: afiliado\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.afiliadoDetail,\n          children: [afiliado && /*#__PURE__*/_jsxDEV(FieldRender, {\n            form: form,\n            field: {\n              name: 'afiliadoNombre',\n              type: FieldType.string,\n              label: 'Afiliado',\n              disabled: true\n            },\n            data: {\n              afiliadoNombre: afiliado && `${afiliado === null || afiliado === void 0 ? void 0 : afiliado.nombre} ${afiliado === null || afiliado === void 0 ? void 0 : afiliado.apellido}`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 15\n          }, this), afiliadoError && /*#__PURE__*/_jsxDEV(Typography, {\n            component: \"h6\",\n            color: \"error\",\n            children: afiliadoError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.disabledField,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: isDisabledCheck,\n            form: form,\n            data: {\n              discapacitado: formContent === null || formContent === void 0 ? void 0 : (_formContent$solicitu3 = formContent.solicitud) === null || _formContent$solicitu3 === void 0 ? void 0 : _formContent$solicitu3.discapacitado\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this), cudVisible === 'true' && /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 3,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.cudField,\n          children: /*#__PURE__*/_jsxDEV(FieldRender, {\n            field: cudField,\n            form: form,\n            data: {\n              cud: afiliado === null || afiliado === void 0 ? void 0 : afiliado.cud\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 13\n        }, this), cudError && /*#__PURE__*/_jsxDEV(Typography, {\n          component: \"h6\",\n          color: \"error\",\n          className: classes.cudError,\n          children: cudError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}","map":{"version":3,"sources":["/reintegros/reintegros-frontend/components/afiliados/AfiliadosSearch.tsx"],"names":["React","useEffect","useState","FieldType","SOLICITUDES","Grid","Typography","makeStyles","FieldRender","send","IconButton","Edit","isUserAdmin","useStyles","theme","afiliadoField","display","afiliadoSearch","paddingLeft","afiliadoDetail","fontSize","disabledField","padding","position","cudField","marginTop","margin","cudEditBtn","right","cudEditIcon","cudError","Afiliados","form","onSelect","formContent","afiliadoError","setAfiliadoError","afiliado","setAfiliado","solicitud","classes","setCudError","cudDisabled","setCudDisabled","cudVisible","setCudVisible","discapacitado","searchConfig","name","type","string","label","help","onChange","value","f","regex","isValid","match","afiliadoTemp","val","url","data","method","headers","error","response","message","setValue","cud","styling","columns","rules","required","fields","disable","int","max","disabled","onBlur","parseInt","updateCud","suffix","isDisabledCheck","radio","options","id","errorMsg","numeroAfiliado","afiliadoNombre","nombre","apellido"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { FieldType } from '../builder/FormField';\nimport { SOLICITUDES } from '../../labels';\nimport { Grid, Typography, makeStyles } from '@material-ui/core';\nimport FieldRender from '../builder/FieldRender';\nimport { send } from '../api-call/service';\nimport { IconButton } from '@material-ui/core';\nimport { Edit } from '@material-ui/icons';\nimport { isUserAdmin } from '../common/helpers';\n\nconst useStyles = makeStyles((theme) => ({\n  afiliadoField: {\n    display: 'None',\n  },\n  afiliadoSearch: {\n    paddingLeft: '10px',\n  },\n  afiliadoDetail: {\n    '& h6': {\n      fontSize: '14px',\n    },\n  },\n  disabledField: {\n    padding: '20px 30px 0',\n    position: 'relative',\n    '& .MuiFormGroup-root': {\n      display: 'block',\n    },\n  },\n  cudField: {\n    marginTop: '15px',\n    '& input': {\n      '&::-webkit-outer-spin-button, &::-webkit-inner-spin-button': {\n        '-webkit-appearance': 'none',\n        margin: 0,\n      },\n    },\n  },\n  cudEditBtn: {\n    padding: '8px',\n    right: '9px',\n  },\n  cudEditIcon: {\n    fontSize: '.8em',\n  },\n  cudError: {\n    fontSize: '14px',\n  },\n}));\n\nexport default function Afiliados({ form, onSelect, formContent }) {\n  const [afiliadoError, setAfiliadoError] = useState('');\n  const [afiliado, setAfiliado] = useState(formContent?.solicitud?.afiliado || null);\n  const classes = useStyles();\n  const [cudError, setCudError] = useState(null);\n  const [cudDisabled, setCudDisabled] = useState(true);\n  const [cudVisible, setCudVisible] = useState(formContent?.solicitud?.discapacitado);\n\n  const searchConfig = {\n    name: 'numeroAfiliado',\n    type: FieldType.string,\n    label: 'Nro. Afiliado',\n    help: 'Formato xx-xxxxxxxx/xx',\n    onChange: async (value, f) => {\n      const regex = /^[0-9]{2}-[0-9]{8}\\/[0-9]{2}$/;\n      const isValid = value.match(regex);\n      let afiliadoTemp = null;\n      setAfiliadoError('');\n      setAfiliado(null);\n      if (isValid) {\n        try {\n          const val = await send({\n            url: `api/verificar/afiliado`,\n            data: { afiliado: value },\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n          });\n          if (val.data.afiliado) {\n            afiliadoTemp = val.data.afiliado;\n          } else {\n            afiliadoTemp = null;\n            setAfiliadoError('Un error');\n          }\n        } catch (error) {\n          afiliadoTemp = null;\n          if (error.response?.data?.message) {\n            setAfiliadoError(error.response.data.message);\n          } else {\n            setAfiliadoError('Error consultando afiliado');\n          }\n        }\n      }\n      form.setValue('afiliado', afiliadoTemp);\n      form.setValue('cud', afiliadoTemp?.cud || '');\n      setAfiliado(afiliadoTemp);\n      onSelect(afiliadoTemp);\n    },\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: true,\n    },\n  };\n  const afiliadoField = {\n    name: 'afiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: true,\n    },\n    disable: true,\n  };\n  const cudField = {\n    name: 'cud',\n    type: FieldType.int,\n    label: SOLICITUDES.fields['cud'],\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: false,\n      max: 9999999999,\n    },\n    disabled: cudDisabled,\n    onBlur: async (value, form) => {\n      setCudError(false);\n      if (!value) {\n        return false;\n      }\n\n      if (parseInt(value) > cudField.rules.max) {\n        setCudError('El valor no ser mayor a ' + cudField.rules.max);\n        return false;\n      }\n\n      updateCud(value);\n    },\n    suffix: (\n      <>\n        {cudDisabled && isUserAdmin() && (\n          <IconButton\n            onClick={() => {\n              setCudDisabled(false);\n            }}\n            color=\"default\"\n            className={classes.cudEditBtn}\n          >\n            <Edit className={classes.cudEditIcon} />\n          </IconButton>\n        )}\n      </>\n    ),\n  };\n  const isDisabledCheck = {\n    name: 'discapacitado',\n    type: FieldType.radio,\n    label: SOLICITUDES.fields['discapacitado'],\n    options: [\n      { label: 'Si', value: 'true' },\n      { label: 'No', value: 'false' },\n    ],\n    styling: {\n      columns: 3,\n    },\n    rules: {\n      required: false,\n    },\n    onChange: (val, form) => {\n      setCudVisible(val);\n      onSelect(afiliado);\n    },\n  };\n\n  useEffect(() => {\n    if (isUserAdmin()) {\n      setCudDisabled(isUserAdmin() && afiliado && afiliado.cud ? true : false);\n    }\n  }, [afiliado, setCudDisabled]);\n\n  const updateCud = async (cud) => {\n    setCudError(null);\n    try {\n      const val = await send({\n        url: `api/verificar/cud`,\n        data: { afiliado: afiliado?.id, cud: cud },\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n      setCudDisabled(true);\n      onSelect({ ...afiliado, cud: cud });\n    } catch (error) {\n      const errorMsg = error.response?.data?.message || 'Error validando CUD';\n      setCudError(errorMsg);\n    }\n  };\n\n  return (\n    <>\n      <Grid container spacing={2}>\n        <Grid item md={3}>\n          <div className={classes.afiliadoSearch}>\n            <FieldRender\n              field={searchConfig}\n              form={form}\n              data={{ numeroAfiliado: afiliado?.numeroAfiliado }}\n            />\n          </div>\n        </Grid>\n        <Grid item md={3}>\n          <div className={classes.afiliadoField}>\n            <FieldRender field={afiliadoField} form={form} data={{ afiliado: afiliado }} />\n          </div>\n          <div className={classes.afiliadoDetail}>\n            {afiliado && (\n              <FieldRender\n                form={form}\n                field={{\n                  name: 'afiliadoNombre',\n                  type: FieldType.string,\n                  label: 'Afiliado',\n                  disabled: true,\n                }}\n                data={{\n                  afiliadoNombre: afiliado && `${afiliado?.nombre} ${afiliado?.apellido}`,\n                }}\n              />\n            )}\n\n            {afiliadoError && (\n              <Typography component=\"h6\" color=\"error\">\n                {afiliadoError}\n              </Typography>\n            )}\n          </div>\n        </Grid>\n      </Grid>\n      <Grid container spacing={2}>\n        <Grid item md={3}>\n          <div className={classes.disabledField}>\n            <FieldRender\n              field={isDisabledCheck}\n              form={form}\n              data={{ discapacitado: formContent?.solicitud?.discapacitado }}\n            />\n          </div>\n        </Grid>\n        {cudVisible === 'true' && (\n          <Grid item md={3}>\n            <div className={classes.cudField}>\n              <FieldRender field={cudField} form={form} data={{ cud: afiliado?.cud }} />\n            </div>\n            {cudError && (\n              <Typography component=\"h6\" color=\"error\" className={classes.cudError}>\n                {cudError}\n              </Typography>\n            )}\n          </Grid>\n        )}\n      </Grid>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}