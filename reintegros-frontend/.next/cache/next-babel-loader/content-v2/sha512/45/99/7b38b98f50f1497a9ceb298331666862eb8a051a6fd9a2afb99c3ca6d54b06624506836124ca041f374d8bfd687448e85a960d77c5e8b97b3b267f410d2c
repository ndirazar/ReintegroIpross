{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/reintegros/reintegros-frontend/components/users/Users.tsx\";\nimport { Box } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport useSWR from 'swr';\nimport UsersForm from './UsersForm';\nimport UsersList from './UsersList';\nimport AutorenewIcon from '@material-ui/icons/Autorenew';\nimport { ERRORS, INFO, LOADING, USERS } from '../../labels';\nimport ActionBar from '../common/ActionBar';\nimport { patch, post } from '../api-call/service';\nimport Loading from '../common/Loading';\nimport Alert from '../common/Alert';\nexport default function Users() {\n  const {\n    data,\n    error: errorOnGet,\n    mutate\n  } = useSWR('api/usuarios');\n  const {\n    data: grupos,\n    error: errorOnGetGroup,\n    mutate: mutateGroup\n  } = useSWR('api/groups/');\n  const {\n    data: delegaciones,\n    error: errorOnGetDelegaciones,\n    mutate: mutateDelegacion\n  } = useSWR('api/delegaciones/');\n  const {\n    0: openForm,\n    1: setOpenForm\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(null);\n  const {\n    0: info,\n    1: setInfo\n  } = useState(null);\n\n  const handleSetDelegaciones = async (delegacionesSelected, userId) => {\n    try {\n      await patch('api/usuarios', {\n        delegaciones: delegacionesSelected\n      }, userId);\n      setInfo(INFO.setDelegaciones);\n      mutateDelegacion();\n    } catch (error) {\n      setError('onSetDelegaciones');\n    }\n  };\n\n  const handleSetGroups = async (groupsSelected, userId) => {\n    try {\n      await patch('api/usuarios', {\n        groups: groupsSelected\n      }, userId);\n      setInfo(INFO.setGroups);\n      mutateGroup();\n    } catch (error) {\n      setError('onSetGroups');\n    }\n  };\n\n  const handleDeactivate = async (id, state) => {\n    try {\n      await patch('api/usuarios', {\n        is_active: !state\n      }, id);\n      mutate();\n    } catch (error) {\n      setError('onDeactivate');\n    }\n  };\n\n  const userActions = [{\n    label: USERS.customActions.sync,\n    onClick: async () => {\n      try {\n        var _res$data$count, _res$data;\n\n        const res = await post('api/ldap-sync-users', {});\n        setInfo(INFO.onSync(USERS.name, (_res$data$count = res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.count) !== null && _res$data$count !== void 0 ? _res$data$count : 0));\n        mutate();\n      } catch (error) {\n        setError('onSync');\n      }\n    },\n    icon: /*#__PURE__*/_jsxDEV(AutorenewIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this)\n  }];\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(ActionBar, {\n      actions: userActions\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      p: 2,\n      m: 1,\n      border: \"1px solid #c4c4c4\",\n      children: [openForm && /*#__PURE__*/_jsxDEV(UsersForm, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 22\n      }, this), data && /*#__PURE__*/_jsxDEV(UsersList, {\n        data: data,\n        delegaciones: delegaciones,\n        grupos: grupos,\n        onUserDeactivate: handleDeactivate,\n        onhandleSetGroups: handleSetGroups,\n        onhandleSetDelegaciones: handleSetDelegaciones\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Loading, {\n      loading: !data,\n      message: LOADING(USERS.name)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Alert, {\n      open: errorOnGet || errorOnGetDelegaciones || errorOnGetGroup || error || info,\n      severity: info ? 'success' : 'error',\n      message: info ? info : error ? ERRORS[error](USERS.name) : ERRORS.onGet(USERS.name),\n      autoHideAfter: 3000,\n      onClose: () => {\n        setError(null);\n        setInfo(null);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}","map":{"version":3,"sources":["/reintegros/reintegros-frontend/components/users/Users.tsx"],"names":["Box","React","useState","useSWR","UsersForm","UsersList","AutorenewIcon","ERRORS","INFO","LOADING","USERS","ActionBar","patch","post","Loading","Alert","Users","data","error","errorOnGet","mutate","grupos","errorOnGetGroup","mutateGroup","delegaciones","errorOnGetDelegaciones","mutateDelegacion","openForm","setOpenForm","setError","info","setInfo","handleSetDelegaciones","delegacionesSelected","userId","setDelegaciones","handleSetGroups","groupsSelected","groups","setGroups","handleDeactivate","id","state","is_active","userActions","label","customActions","sync","onClick","res","onSync","name","count","icon","onGet"],"mappings":"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","sourcesContent":["import { Box, createStyles, Fab, makeStyles, Theme } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport useSWR from 'swr';\nimport UsersForm from './UsersForm';\nimport UsersList from './UsersList';\nimport AutorenewIcon from '@material-ui/icons/Autorenew';\nimport { Action } from '../common/types/Action';\nimport { ERRORS, INFO, LOADING, USERS } from '../../labels';\nimport ActionBar from '../common/ActionBar';\nimport { patch, post } from '../api-call/service';\nimport Loading from '../common/Loading';\nimport Alert from '../common/Alert';\n\nexport default function Users() {\n  const { data, error: errorOnGet, mutate } = useSWR('api/usuarios');\n  const { data: grupos, error: errorOnGetGroup, mutate: mutateGroup } = useSWR('api/groups/');\n  const { data: delegaciones, error: errorOnGetDelegaciones, mutate: mutateDelegacion } = useSWR(\n    'api/delegaciones/',\n  );\n  const [openForm, setOpenForm] = useState(false);\n  const [error, setError] = useState(null);\n  const [info, setInfo] = useState(null);\n\n  const handleSetDelegaciones = async (delegacionesSelected, userId) => {\n    try {\n      await patch('api/usuarios', { delegaciones: delegacionesSelected }, userId);\n      setInfo(INFO.setDelegaciones);\n      mutateDelegacion();\n    } catch (error) {\n      setError('onSetDelegaciones');\n    }\n  };\n\n  const handleSetGroups = async (groupsSelected, userId) => {\n    try {\n      await patch('api/usuarios', { groups: groupsSelected }, userId);\n      setInfo(INFO.setGroups);\n      mutateGroup();\n    } catch (error) {\n      setError('onSetGroups');\n    }\n  };\n\n  const handleDeactivate = async (id: number, state: boolean) => {\n    try {\n      await patch('api/usuarios', { is_active: !state }, id);\n      mutate();\n    } catch (error) {\n      setError('onDeactivate');\n    }\n  };\n  const userActions: Action[] = [\n    {\n      label: USERS.customActions.sync,\n      onClick: async () => {\n        try {\n          const res = await post('api/ldap-sync-users', {});\n          setInfo(INFO.onSync(USERS.name, res?.data?.count ?? 0));\n          mutate();\n        } catch (error) {\n          setError('onSync');\n        }\n      },\n      icon: <AutorenewIcon />,\n    },\n  ];\n\n  return (\n    <>\n      <ActionBar actions={userActions} />\n      <Box p={2} m={1} border=\"1px solid #c4c4c4\">\n        {openForm && <UsersForm />}\n        {data && (\n          <UsersList\n            data={data}\n            delegaciones={delegaciones}\n            grupos={grupos}\n            onUserDeactivate={handleDeactivate}\n            onhandleSetGroups={handleSetGroups}\n            onhandleSetDelegaciones={handleSetDelegaciones}\n          />\n        )}\n      </Box>\n      <Loading loading={!data} message={LOADING(USERS.name)} />\n      <Alert\n        open={errorOnGet || errorOnGetDelegaciones || errorOnGetGroup || error || info}\n        severity={info ? 'success' : 'error'}\n        message={info ? info : error ? ERRORS[error](USERS.name) : ERRORS.onGet(USERS.name)}\n        autoHideAfter={3000}\n        onClose={() => {\n          setError(null);\n          setInfo(null);\n        }}\n      />\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}