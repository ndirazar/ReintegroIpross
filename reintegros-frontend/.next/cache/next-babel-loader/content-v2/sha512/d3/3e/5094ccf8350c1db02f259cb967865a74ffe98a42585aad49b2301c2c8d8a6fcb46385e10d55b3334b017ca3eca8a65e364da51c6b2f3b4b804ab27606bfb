{"ast":null,"code":"import _defineProperty from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/reintegros/reintegros-frontend/components/solicitudes/prestaciones/FormEditPrestaciones.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Box } from '@material-ui/core';\nimport React, { useEffect, useState } from 'react';\nimport { NOMENCLADOR, PRESTACIONES } from '../../../labels';\nimport AttachMoneyOutlinedIcon from '@material-ui/icons/AttachMoneyOutlined';\nimport Form, { FieldType } from '../../builder';\nimport { parseISO, subDays } from 'date-fns';\nimport { get } from '../../api-call/service';\nexport var FormEditPrestaciones = function FormEditPrestaciones(_ref) {\n  _s();\n\n  var prestacion = _ref.prestacion,\n      submit = _ref.submit,\n      onCancel = _ref.onCancel;\n\n  var _useState = useState(new Date()),\n      fechaDesde = _useState[0],\n      setFechaDesde = _useState[1];\n\n  var _useState2 = useState(prestacion.isDateRange === 'range'),\n      isDateRange = _useState2[0],\n      setIsDateRange = _useState2[1];\n\n  var _useState3 = useState(null),\n      fechaVigenciaHastaLiminit = _useState3[0],\n      setFechaVigenciaHastaLimit = _useState3[1];\n\n  var _useState4 = useState(false),\n      loaded = _useState4[0],\n      setLoaded = _useState4[1];\n\n  var _useState5 = useState({\n    prestaciones: []\n  }),\n      solicitud = _useState5[0],\n      setSolicitud = _useState5[1];\n\n  var _useState6 = useState({}),\n      nomenclador = _useState6[0],\n      setNomenclador = _useState6[1];\n\n  var prestadores = [];\n  var configPrestaciones = [{\n    name: 'capitulo',\n    type: FieldType.options,\n    label: PRESTACIONES.fields.capitulo,\n    options: function () {\n      var _options = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", [{\n                  value: prestacion.capitulo.value,\n                  label: prestacion.capitulo.label\n                }]);\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function options() {\n        return _options.apply(this, arguments);\n      }\n\n      return options;\n    }(),\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true\n    },\n    disabled: true\n  }, {\n    name: 'nomenclador',\n    type: FieldType.options,\n    label: PRESTACIONES.fields.nomenclador,\n    options: function () {\n      var _options2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(form, query) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", [{\n                  value: prestacion.nomenclador.value,\n                  label: prestacion.nomenclador.label\n                }]);\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function options(_x, _x2) {\n        return _options2.apply(this, arguments);\n      }\n\n      return options;\n    }(),\n    styling: {\n      columns: 12\n    },\n    rules: {\n      required: true\n    },\n    disabled: true\n  }, {\n    name: 'isDateRange',\n    type: FieldType.options,\n    label: 'Fecha / Rango',\n    options: PRESTACIONES.optionsDate,\n    styling: {\n      columns: 6\n    },\n    onChange: function onChange(val, form) {\n      setIsDateRange(val === 'range');\n    }\n  }, {\n    name: 'fechaPractica',\n    type: FieldType.date,\n    label: PRESTACIONES.fields.fechaPractica,\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true,\n      min: subDays(new Date(), 60).toString(),\n      max: new Date().toString()\n    },\n    onChange: function onChange(val, form) {\n      setFechaDesde(val);\n    }\n  }, {\n    name: 'fechaPracticaHasta',\n    type: FieldType.date,\n    label: PRESTACIONES.fields.fechaPracticaHasta,\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true,\n      min: fechaDesde.toString(),\n      max: fechaVigenciaHastaLiminit\n    },\n    disabled: !isDateRange\n  }, {\n    name: 'modalidad',\n    type: FieldType.options,\n    label: PRESTACIONES.fields.modalidad,\n    options: NOMENCLADOR.optionsModalidadPresentacion,\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true\n    },\n    disabled: true\n  }, {\n    name: 'cobertura',\n    type: FieldType.string,\n    label: PRESTACIONES.fields.cobertura,\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true\n    },\n    disabled: true,\n    prefix: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: \"%\"\n    }, void 0, false)\n  }, {\n    name: 'estadoActual',\n    type: FieldType.options,\n    label: PRESTACIONES.fields['estadoActual'],\n    options: PRESTACIONES.optionsEstadoActual,\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true\n    },\n    disabled: true\n  }, {\n    name: 'prestador',\n    type: FieldType.options,\n    label: PRESTACIONES.fields.prestador,\n    options: function () {\n      var _options3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.abrupt(\"return\", prestadores);\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function options() {\n        return _options3.apply(this, arguments);\n      }\n\n      return options;\n    }(),\n    onUpdate: function () {\n      var _onUpdate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(val, form) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!(val === '')) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                prestadores = [];\n                return _context4.abrupt(\"return\");\n\n              case 3:\n                _context4.next = 5;\n                return get(\"api/prestadores/?profEstado=alta&matricula=\".concat(val));\n\n              case 5:\n                prestadores = _context4.sent.data.results.map(function (p) {\n                  return {\n                    value: p.id,\n                    label: \"\".concat(p.matricula, \" - \").concat(p.nombre, \" \").concat(p.apellido)\n                  };\n                });\n\n              case 6:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      function onUpdate(_x3, _x4) {\n        return _onUpdate.apply(this, arguments);\n      }\n\n      return onUpdate;\n    }(),\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true\n    },\n    help: 'Si no encuentra el prestador, solicite el alta al Administrador del sistema.'\n  }, {\n    name: 'br',\n    type: FieldType.br,\n    label: ''\n  }, {\n    name: 'valorIprossNomenclador',\n    type: FieldType.string,\n    label: PRESTACIONES.fields.valorIprossNomenclador,\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    },\n    disabled: true,\n    prefix: /*#__PURE__*/_jsxDEV(AttachMoneyOutlinedIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 15\n    }, _this)\n  }, {\n    name: 'montoTotal',\n    type: FieldType.string,\n    label: PRESTACIONES.fields.montoTotal,\n    styling: {\n      columns: 3\n    },\n    rules: {\n      min: 1,\n      required: true\n    },\n    disabled: true\n  }, {\n    name: 'valorPrestacion',\n    type: FieldType[\"float\"],\n    label: PRESTACIONES.fields.valorPrestacion,\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    },\n    prefix: /*#__PURE__*/_jsxDEV(AttachMoneyOutlinedIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 15\n    }, _this)\n  }, {\n    name: 'montoReintegrar',\n    type: FieldType.string,\n    label: PRESTACIONES.fields.montoReintegrar,\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    },\n    disabled: true,\n    prefix: /*#__PURE__*/_jsxDEV(AttachMoneyOutlinedIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 15\n    }, _this)\n  }, {\n    name: 'cantidad',\n    type: FieldType[\"int\"],\n    label: PRESTACIONES.fields.cantidad,\n    styling: {\n      columns: 6\n    },\n    rules: {\n      min: 1,\n      required: true\n    },\n    onChange: function onChange(val, form) {\n      var valorIpross = form.getValues()['valorIprossNomenclador'];\n      var montoTotal = valorIpross * val;\n      form.setValue('montoTotal', montoTotal.toFixed(2));\n      var cobertura = form.getValues()['cobertura'];\n      var montoReintegrar = (valorIpross * val * (parseInt(cobertura) / 100)).toFixed(2);\n      form.setValue('montoReintegrar', montoReintegrar);\n    }\n  }, {\n    name: 'periodo',\n    type: FieldType.options,\n    options: NOMENCLADOR.optionsPeriodoTope,\n    label: PRESTACIONES.fields.periodo,\n    styling: {\n      columns: 6\n    },\n    rules: {\n      required: true\n    }\n  }];\n\n  var handleCancelPrestacion = function handleCancelPrestacion() {\n    onCancel();\n  };\n\n  var handleSubmitPrestacion = function handleSubmitPrestacion(data) {\n    submit(_objectSpread({\n      id: prestacion.id\n    }, data));\n  };\n\n  useEffect(function () {\n    console.log({\n      prestacion: prestacion\n    });\n\n    if (!loaded) {\n      get(\"api/solicitudes/\".concat(prestacion.solicitud.id)).then(function (response) {\n        setSolicitud(response.data);\n      });\n      get(\"api/nomenclador/\".concat(prestacion.nomenclador.value)).then(function (response) {\n        var _response$data, _response$data2;\n\n        setNomenclador(response === null || response === void 0 ? void 0 : response.data);\n        setFechaVigenciaHastaLimit(response !== null && response !== void 0 && (_response$data = response.data) !== null && _response$data !== void 0 && _response$data.fechaVigenciaHasta ? parseISO(response === null || response === void 0 ? void 0 : (_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.fechaVigenciaHasta) : null);\n        console.log({\n          nomenclador: response.data\n        });\n      });\n      setLoaded(true);\n    }\n  }, [prestacion]);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    margin: 3,\n    children: /*#__PURE__*/_jsxDEV(Form, {\n      config: configPrestaciones,\n      data: prestacion,\n      onSubmit: handleSubmitPrestacion,\n      onCancel: function onCancel() {\n        handleCancelPrestacion();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 290,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(FormEditPrestaciones, \"AwtEy7dDANzAJwypRBZvABWTnvk=\");\n\n_c = FormEditPrestaciones;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormEditPrestaciones\");","map":{"version":3,"sources":["/reintegros/reintegros-frontend/components/solicitudes/prestaciones/FormEditPrestaciones.tsx"],"names":["Box","React","useEffect","useState","NOMENCLADOR","PRESTACIONES","AttachMoneyOutlinedIcon","Form","FieldType","parseISO","subDays","get","FormEditPrestaciones","prestacion","submit","onCancel","Date","fechaDesde","setFechaDesde","isDateRange","setIsDateRange","fechaVigenciaHastaLiminit","setFechaVigenciaHastaLimit","loaded","setLoaded","prestaciones","solicitud","setSolicitud","nomenclador","setNomenclador","prestadores","configPrestaciones","name","type","options","label","fields","capitulo","value","styling","columns","rules","required","disabled","form","query","optionsDate","onChange","val","date","fechaPractica","min","toString","max","fechaPracticaHasta","modalidad","optionsModalidadPresentacion","string","cobertura","prefix","optionsEstadoActual","prestador","onUpdate","data","results","map","p","id","matricula","nombre","apellido","help","br","valorIprossNomenclador","montoTotal","valorPrestacion","montoReintegrar","cantidad","valorIpross","getValues","setValue","toFixed","parseInt","optionsPeriodoTope","periodo","handleCancelPrestacion","handleSubmitPrestacion","console","log","then","response","fechaVigenciaHasta"],"mappings":"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","sourcesContent":["import { Box } from '@material-ui/core';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { NOMENCLADOR, PRESTACIONES } from '../../../labels';\nimport { FormConfig } from '../../builder/FormConfig';\nimport { FormDataPrestaciones } from './types';\nimport AttachMoneyOutlinedIcon from '@material-ui/icons/AttachMoneyOutlined';\nimport Form, { FieldType } from '../../builder';\nimport { parseISO, subDays } from 'date-fns';\nimport { get } from '../../api-call/service';\n\nexport const FormEditPrestaciones = ({ prestacion, submit, onCancel }) => {\n  const [fechaDesde, setFechaDesde] = useState(new Date());\n  const [isDateRange, setIsDateRange] = useState(prestacion.isDateRange === 'range');\n  const [fechaVigenciaHastaLiminit, setFechaVigenciaHastaLimit] = useState(null);\n  const [loaded, setLoaded] = useState(false);\n  const [solicitud, setSolicitud] = useState({ prestaciones: [] });\n  const [nomenclador, setNomenclador] = useState({});\n\n  let prestadores = [];\n  const configPrestaciones: FormConfig<FormDataPrestaciones> = [\n    {\n      name: 'capitulo',\n      type: FieldType.options,\n      label: PRESTACIONES.fields.capitulo,\n      options: async () => {\n        return [\n          {\n            value: prestacion.capitulo.value,\n            label: prestacion.capitulo.label,\n          },\n        ];\n      },\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n      },\n      disabled: true,\n    },\n    {\n      name: 'nomenclador',\n      type: FieldType.options,\n      label: PRESTACIONES.fields.nomenclador,\n      options: async (form, query) => {\n        return [\n          {\n            value: prestacion.nomenclador.value,\n            label: prestacion.nomenclador.label,\n          },\n        ];\n      },\n      styling: {\n        columns: 12,\n      },\n      rules: {\n        required: true,\n      },\n      disabled: true,\n    },\n    {\n      name: 'isDateRange',\n      type: FieldType.options,\n      label: 'Fecha / Rango',\n      options: PRESTACIONES.optionsDate,\n      styling: {\n        columns: 6,\n      },\n      onChange: (val, form) => {\n        setIsDateRange(val === 'range');\n      },\n    },\n    {\n      name: 'fechaPractica',\n      type: FieldType.date,\n      label: PRESTACIONES.fields.fechaPractica,\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n        min: subDays(new Date(), 60).toString(),\n        max: new Date().toString(),\n      },\n      onChange: (val, form) => {\n        setFechaDesde(val);\n      },\n    },\n    {\n      name: 'fechaPracticaHasta',\n      type: FieldType.date,\n      label: PRESTACIONES.fields.fechaPracticaHasta,\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n        min: fechaDesde.toString(),\n        max: fechaVigenciaHastaLiminit,\n      },\n      disabled: !isDateRange,\n    },\n    {\n      name: 'modalidad',\n      type: FieldType.options,\n      label: PRESTACIONES.fields.modalidad,\n      options: NOMENCLADOR.optionsModalidadPresentacion,\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n      },\n      disabled: true,\n    },\n    {\n      name: 'cobertura',\n      type: FieldType.string,\n      label: PRESTACIONES.fields.cobertura,\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n      },\n      disabled: true,\n      prefix: <>%</>,\n    },\n    {\n      name: 'estadoActual',\n      type: FieldType.options,\n      label: PRESTACIONES.fields['estadoActual'],\n      options: PRESTACIONES.optionsEstadoActual,\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n      },\n      disabled: true,\n    },\n    {\n      name: 'prestador',\n      type: FieldType.options,\n      label: PRESTACIONES.fields.prestador,\n      options: async () => {\n        return prestadores;\n      },\n      onUpdate: async (val, form) => {\n        if (val === '') {\n          prestadores = [];\n          return;\n        }\n        prestadores = (\n          await get(`api/prestadores/?profEstado=alta&matricula=${val}`)\n        ).data.results.map((p) => ({\n          value: p.id,\n          label: `${p.matricula} - ${p.nombre} ${p.apellido}`,\n        }));\n      },\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n      },\n      help: 'Si no encuentra el prestador, solicite el alta al Administrador del sistema.',\n    },\n    {\n      name: 'br',\n      type: FieldType.br,\n      label: '',\n    },\n    {\n      name: 'valorIprossNomenclador',\n      type: FieldType.string,\n      label: PRESTACIONES.fields.valorIprossNomenclador,\n      styling: {\n        columns: 3,\n      },\n      rules: {\n        required: true,\n      },\n      disabled: true,\n      prefix: <AttachMoneyOutlinedIcon />,\n    },\n    {\n      name: 'montoTotal',\n      type: FieldType.string,\n      label: PRESTACIONES.fields.montoTotal,\n      styling: {\n        columns: 3,\n      },\n      rules: {\n        min: 1,\n        required: true,\n      },\n      disabled: true,\n    },\n    {\n      name: 'valorPrestacion',\n      type: FieldType.float,\n      label: PRESTACIONES.fields.valorPrestacion,\n      styling: {\n        columns: 3,\n      },\n      rules: {\n        required: true,\n      },\n      prefix: <AttachMoneyOutlinedIcon />,\n    },\n    {\n      name: 'montoReintegrar',\n      type: FieldType.string,\n      label: PRESTACIONES.fields.montoReintegrar,\n      styling: {\n        columns: 3,\n      },\n      rules: {\n        required: true,\n      },\n      disabled: true,\n      prefix: <AttachMoneyOutlinedIcon />,\n    },\n    {\n      name: 'cantidad',\n      type: FieldType.int,\n      label: PRESTACIONES.fields.cantidad,\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        min: 1,\n        required: true,\n      },\n      onChange: (val, form) => {\n        const valorIpross = form.getValues()['valorIprossNomenclador'];\n        const montoTotal = valorIpross * val;\n        form.setValue('montoTotal', montoTotal.toFixed(2));\n        const cobertura = form.getValues()['cobertura'];\n\n        const montoReintegrar = (valorIpross * val * (parseInt(cobertura) / 100)).toFixed(2);\n\n        form.setValue('montoReintegrar', montoReintegrar);\n      },\n    },\n    {\n      name: 'periodo',\n      type: FieldType.options,\n      options: NOMENCLADOR.optionsPeriodoTope,\n      label: PRESTACIONES.fields.periodo,\n      styling: {\n        columns: 6,\n      },\n      rules: {\n        required: true,\n      },\n    },\n  ];\n\n  const handleCancelPrestacion = () => {\n    onCancel();\n  };\n\n  const handleSubmitPrestacion = (data) => {\n    submit({\n      id: prestacion.id,\n      ...data,\n    });\n  };\n\n  useEffect(() => {\n    console.log({ prestacion });\n    if (!loaded) {\n      get(`api/solicitudes/${prestacion.solicitud.id}`).then((response) => {\n        setSolicitud(response.data);\n      });\n      get(`api/nomenclador/${prestacion.nomenclador.value}`).then((response) => {\n        setNomenclador(response?.data);\n        setFechaVigenciaHastaLimit(\n          response?.data?.fechaVigenciaHasta ? parseISO(response?.data?.fechaVigenciaHasta) : null,\n        );\n        console.log({ nomenclador: response.data });\n      });\n      setLoaded(true);\n    }\n  }, [prestacion]);\n\n  return (\n    <Box margin={3}>\n      <Form\n        config={configPrestaciones}\n        data={prestacion}\n        onSubmit={handleSubmitPrestacion}\n        onCancel={() => {\n          handleCancelPrestacion();\n        }}\n      />\n    </Box>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}