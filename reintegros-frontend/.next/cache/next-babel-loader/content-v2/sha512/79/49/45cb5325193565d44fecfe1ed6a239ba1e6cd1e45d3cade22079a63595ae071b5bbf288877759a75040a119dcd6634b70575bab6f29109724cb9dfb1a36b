{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState } from 'react';\nimport { List, ListItem, ListItemText, Box, Divider, Typography, Badge, ListSubheader, Chip } from '@material-ui/core';\nimport useStyles from './NotificacionesStyle';\nimport { formatDateNotification, getUser } from '../common/helpers';\nimport { send } from '../api-call/service';\nexport default function Notificaciones(_ref) {\n  var _getItemsList;\n\n  var notificaciones = _ref.notificaciones,\n      onUpdateNotificaciones = _ref.onUpdateNotificaciones;\n  var classes = useStyles();\n\n  var _useState = useState(true),\n      tabSolicitudes = _useState[0],\n      setTabSolicitudes = _useState[1];\n\n  var markNotificationAsRead = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(notificacion) {\n      var user, preview;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              user = getUser();\n              _context.next = 3;\n              return send({\n                url: \"api/usuarios/\".concat(user.id, \"/marcar-notificacion-como-leida/\").concat(notificacion.id),\n                method: 'PUT',\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n\n            case 3:\n              preview = _context.sent;\n              localStorage.setItem('notifications', JSON.stringify(preview.data.notifications));\n              onUpdateNotificaciones(preview.data.notifications);\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function markNotificationAsRead(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  /**\n   * Funcion que se encarga de retornar el listado de notificaciones segun el\n   * tab que este seleccionado (solicitudes, solicitudes autorizadas)\n   */\n\n\n  var getItemsList = function getItemsList() {\n    if (tabSolicitudes) {\n      var notificacionesSelected = notificaciones === null || notificaciones === void 0 ? void 0 : notificaciones.filter(function (notificacion) {\n        return notificacion.tipo === 'solicitud';\n      });\n      return notificacionesSelected;\n    } else {\n      var _notificacionesSelected = notificaciones === null || notificaciones === void 0 ? void 0 : notificaciones.filter(function (notificacion) {\n        return notificacion.tipo === 'autorizacion';\n      });\n\n      return _notificacionesSelected;\n    }\n  };\n\n  var switchToSolicitudesAutorizadas = function switchToSolicitudesAutorizadas() {\n    setTabSolicitudes(false);\n  };\n\n  var switchToSolicitudes = function switchToSolicitudes() {\n    setTabSolicitudes(true);\n  };\n  /**\n   * Funcion que se encarga de retornar las cantidad de notificaciones\n   * no leidas del tipo de solicitud\n   */\n\n\n  var cantidadDeNotificacionesDeSolicitudes = function cantidadDeNotificacionesDeSolicitudes() {\n    return notificaciones === null || notificaciones === void 0 ? void 0 : notificaciones.filter(function (notificacion) {\n      return notificacion.tipo === 'solicitud' && notificacion.visto == false;\n    }).length;\n  };\n  /**\n   * Funcion que se encarga de retornar las cantidad de notificaciones\n   * no leidas del tipo de solicitudes autorizadas\n   */\n\n\n  var cantidadDeNotificacionesDeAutorizaciones = function cantidadDeNotificacionesDeAutorizaciones() {\n    return notificaciones === null || notificaciones === void 0 ? void 0 : notificaciones.filter(function (notificacion) {\n      return notificacion.tipo === 'autorizacion' && notificacion.visto == false;\n    }).length;\n  };\n\n  return /*#__PURE__*/_jsx(Box, {\n    boxShadow: 4,\n    className: classes.root,\n    children: /*#__PURE__*/_jsx(List, {\n      className: classes.list,\n      subheader: /*#__PURE__*/_jsxs(ListSubheader, {\n        className: classes.subHeader,\n        children: [/*#__PURE__*/_jsxs(Box, {\n          children: [/*#__PURE__*/_jsx(Typography, {\n            className: classes.titleSubHeader,\n            children: \"Notificaciones\"\n          }), /*#__PURE__*/_jsxs(Box, {\n            display: \"flex\",\n            className: classes.chips,\n            children: [/*#__PURE__*/_jsx(Badge, {\n              color: \"secondary\",\n              badgeContent: cantidadDeNotificacionesDeSolicitudes(),\n              className: classes.chipSolicitudes,\n              children: /*#__PURE__*/_jsx(Chip, {\n                label: \"Solicitudes\",\n                color: \"primary\",\n                clickable: true,\n                onClick: switchToSolicitudes,\n                className: \"\".concat(classes.chip, \" \").concat(tabSolicitudes ? 'active' : '')\n              })\n            }), /*#__PURE__*/_jsx(Badge, {\n              color: \"secondary\",\n              badgeContent: cantidadDeNotificacionesDeAutorizaciones(),\n              children: /*#__PURE__*/_jsx(Chip, {\n                label: \"Solicitudes Autorizadas\",\n                color: \"primary\",\n                onClick: switchToSolicitudesAutorizadas,\n                clickable: true,\n                className: \"\".concat(classes.chip, \" \").concat(tabSolicitudes ? '' : 'active')\n              })\n            })]\n          })]\n        }), /*#__PURE__*/_jsx(Divider, {})]\n      }),\n      children: (_getItemsList = getItemsList()) === null || _getItemsList === void 0 ? void 0 : _getItemsList.map(function (notificacion) {\n        return /*#__PURE__*/_jsx(Box, {\n          children: /*#__PURE__*/_jsx(ListItem, {\n            button: true,\n            selected: !notificacion.visto,\n            onClick: function onClick() {\n              return markNotificationAsRead(notificacion);\n            },\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              style: {\n                width: '100%'\n              },\n              children: [/*#__PURE__*/_jsxs(Box, {\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                children: [/*#__PURE__*/_jsx(Box, {\n                  children: /*#__PURE__*/_jsx(ListItemText, {\n                    primary: /*#__PURE__*/_jsx(Typography, {\n                      className: classes.titleText,\n                      children: notificacion.titulo\n                    }),\n                    secondary: /*#__PURE__*/_jsx(Typography, {\n                      className: classes.mensajeText,\n                      children: notificacion.mensaje\n                    })\n                  })\n                }), /*#__PURE__*/_jsxs(Box, {\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  children: [!notificacion.visto && /*#__PURE__*/_jsx(Box, {\n                    className: classes.badge,\n                    children: /*#__PURE__*/_jsx(Badge, {\n                      color: \"primary\",\n                      variant: \"dot\"\n                    })\n                  }), /*#__PURE__*/_jsx(Box, {\n                    children: /*#__PURE__*/_jsx(ListItemText, {\n                      primary: /*#__PURE__*/_jsx(Typography, {\n                        className: classes.dateText,\n                        children: formatDateNotification(notificacion.fechaDeCreacion)\n                      })\n                    })\n                  })]\n                })]\n              }), /*#__PURE__*/_jsx(Divider, {})]\n            })\n          })\n        }, notificacion.id);\n      })\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}