{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Box, Divider, List, ListItem, ListItemText, Typography } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport { PRESTADORES } from '../../labels';\nimport { send } from '../api-call/service';\nimport Form from '../builder/Form';\nimport configImportPrestadores from './FormImportConfig';\nimport Loading from '../common/Loading';\nimport Modal from '../common/Modal';\nimport SubTitleImportModal from './SubTitleImportModal';\nexport default function PrestadoresImportForm({\n  data,\n  handleSubmit,\n  handleCancel\n}) {\n  const {\n    0: processing,\n    1: setProcessing\n  } = useState(false);\n  const {\n    0: dataPreview,\n    1: setPreviewData\n  } = useState([]);\n  const {\n    0: importFile,\n    1: setImportFile\n  } = useState(null);\n  const {\n    0: openImportModal,\n    1: setOpenImportModal\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(null);\n  const {\n    0: info,\n    1: setInfo\n  } = useState(null);\n\n  const handleCancelImport = async () => {\n    setOpenImportModal(false);\n    handleCancel();\n  };\n\n  const handleSubmitImport = async data => {\n    const formData = new FormData();\n    formData.append('prestadores', data.file);\n    setImportFile(data.file);\n    const preview = await send({\n      url: `api/verificador-prestadores`,\n      data: formData,\n      method: 'POST',\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    setPreviewData(preview.data);\n    setOpenImportModal(true);\n  };\n\n  const handleConfirmImportModal = async () => {\n    const formData = new FormData();\n    formData.append('prestadores', importFile);\n    setProcessing(true);\n    await send({\n      url: `api/importar-prestadores`,\n      data: formData,\n      method: 'POST',\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    setProcessing(false);\n    setInfo(PRESTADORES.messages.successfulImport);\n    setOpenImportModal(false);\n    handleSubmit();\n  };\n\n  return /*#__PURE__*/_jsxs(Box, {\n    p: 2,\n    m: 1,\n    border: \"1px solid #c4c4c4\",\n    children: [/*#__PURE__*/_jsx(Form, {\n      config: configImportPrestadores,\n      data: data,\n      onSubmit: handleSubmitImport,\n      onCancel: handleCancel\n    }), openImportModal && /*#__PURE__*/_jsxs(Modal, {\n      open: true,\n      onClose: () => setOpenImportModal(false),\n      title: PRESTADORES.import,\n      actions: true,\n      onAcept: handleConfirmImportModal,\n      onCancel: handleCancelImport,\n      maxWidth: 'md',\n      subTitle: /*#__PURE__*/_jsx(SubTitleImportModal, {\n        data: dataPreview\n      }),\n      children: [/*#__PURE__*/_jsx(List, {\n        children: dataPreview.map((item, index) => {\n          if (!item.is_valid) {\n            return /*#__PURE__*/_jsxs(Box, {\n              children: [/*#__PURE__*/_jsx(ListItem, {\n                children: /*#__PURE__*/_jsxs(Box, {\n                  children: [/*#__PURE__*/_jsx(Box, {\n                    fontWeight: \"fontWeightBold\",\n                    children: /*#__PURE__*/_jsx(ListItemText, {\n                      primary: /*#__PURE__*/_jsx(Box, {\n                        fontWeight: \"fontWeightBold\",\n                        children: `Fila: ${index + 1}`\n                      })\n                    })\n                  }), /*#__PURE__*/_jsxs(Box, {\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    ml: 5,\n                    children: [/*#__PURE__*/_jsx(Box, {\n                      children: /*#__PURE__*/_jsx(ListItemText, {\n                        primary: \"No es v\\xE1lido\",\n                        secondary: /*#__PURE__*/_jsx(Typography, {\n                          color: \"error\",\n                          children: \"Errores:\"\n                        })\n                      })\n                    }), /*#__PURE__*/_jsx(Box, {\n                      display: \"flex\",\n                      flexDirection: \"column\",\n                      children: item.errors.map(item => {\n                        return /*#__PURE__*/_jsx(ListItemText, {\n                          children: `- ${item}`\n                        });\n                      })\n                    })]\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(Divider, {})]\n            });\n          }\n        })\n      }), /*#__PURE__*/_jsx(Loading, {\n        loading: dataPreview.length == 0 || processing,\n        message: PRESTADORES.messages.processingFileMessage\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}