{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/reintegros/reintegros-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/reintegros/reintegros-frontend/components/solicitudes/Stepper.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport Button from '@material-ui/core/Button';\nimport _ from 'lodash';\nimport Typography from '@material-ui/core/Typography';\nimport { format, parseISO } from 'date-fns';\nimport { get, post, send } from '../api-call/service';\nimport { NOMENCLADOR, PRESTADORES, SOLICITUDES, STEPPER_SOLICITUDES } from '../../labels';\nimport useStyles from './Stepper.styles';\nimport { Box } from '@material-ui/core';\nimport { FormSolicitud } from './FormSolicitud';\nimport { FormPrestaciones } from './prestaciones/FormPrestaciones';\nimport { FormAdjuntos } from './adjuntos/FormAdjuntos';\nimport SolicitudesSummary from './SolicitudesSummary';\nimport Alert from '../common/Alert';\nimport Loading from '../common/Loading';\nexport var FormStepper = function FormStepper(_ref) {\n  _s();\n\n  var setShowStepper = _ref.setShowStepper,\n      onFinished = _ref.onFinished;\n\n  var _useFormContext = useFormContext(),\n      watch = _useFormContext.watch,\n      errors = _useFormContext.errors,\n      trigger = _useFormContext.trigger,\n      setError = _useFormContext.setError;\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activeStep = _React$useState2[0],\n      setActiveStep = _React$useState2[1];\n\n  var _React$useState3 = React.useState({}),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      compiledForm = _React$useState4[0],\n      setCompiledForm = _React$useState4[1];\n\n  var steps = STEPPER_SOLICITUDES.steps.map(function (elem) {\n    return elem.title;\n  });\n  var form = watch();\n\n  var _React$useState5 = React.useState([]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      prestaciones = _React$useState6[0],\n      setPrestaciones = _React$useState6[1];\n\n  var _React$useState7 = React.useState(null),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      solicitud = _React$useState8[0],\n      setSolicitud = _React$useState8[1];\n\n  var _React$useState9 = React.useState(null),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      stepError = _React$useState10[0],\n      setStepError = _React$useState10[1];\n\n  var _React$useState11 = React.useState(false),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      isLoading = _React$useState12[0],\n      setIsLoading = _React$useState12[1];\n\n  var _React$useState13 = React.useState(null),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      idSolicitud = _React$useState14[0],\n      setIdSolicitud = _React$useState14[1];\n\n  var classes = useStyles();\n\n  var addPrestacion = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _form$prestador, _yield$get, _form$nomenclador, _form$capitulo;\n\n      var _prestaciones, prestadorID, nomencladorID, nomenclador;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              form.fechaPractica = format(form === null || form === void 0 ? void 0 : form.fechaPractica, 'yyyy-MM-dd');\n\n              if (form !== null && form !== void 0 && form.fechaPracticaHasta) {\n                form.fechaPracticaHasta = format(form === null || form === void 0 ? void 0 : form.fechaPracticaHasta, 'yyyy-MM-dd');\n              }\n\n              form.cobertura = parseInt(form.cobertura);\n              _prestaciones = prestaciones;\n\n              if (form.capitulo === 40 || form.capitulo === 41 || form.capitulo === 43) {\n                _prestaciones = _prestaciones.map(function (p) {\n                  console.log({\n                    p: p\n                  });\n\n                  if (p.capitulo !== 40 && p.capitulo !== 41 && p.capitulo !== 43) {\n                    p.cobertura = 100;\n                  } else {\n                    p.cobertura = 90;\n                  }\n\n                  return p;\n                });\n              }\n\n              prestadorID = ((_form$prestador = form.prestador) === null || _form$prestador === void 0 ? void 0 : _form$prestador.value) || form.prestador;\n              _context.next = 8;\n              return get(\"\".concat(PRESTADORES.route, \"/\").concat(prestadorID, \"/\"));\n\n            case 8:\n              _context.t1 = _yield$get = _context.sent;\n              _context.t0 = _context.t1 === null;\n\n              if (_context.t0) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.t0 = _yield$get === void 0;\n\n            case 12:\n              if (!_context.t0) {\n                _context.next = 16;\n                break;\n              }\n\n              _context.t2 = void 0;\n              _context.next = 17;\n              break;\n\n            case 16:\n              _context.t2 = _yield$get.data;\n\n            case 17:\n              form.prestador = _context.t2;\n              nomencladorID = ((_form$nomenclador = form.nomenclador) === null || _form$nomenclador === void 0 ? void 0 : _form$nomenclador.value) || form.nomenclador;\n              _context.next = 21;\n              return get(\"\".concat(NOMENCLADOR.route, \"/\").concat(nomencladorID, \"/\"));\n\n            case 21:\n              nomenclador = _context.sent;\n              form.capitulo = ((_form$capitulo = form.capitulo) === null || _form$capitulo === void 0 ? void 0 : _form$capitulo.value) || form.capitulo;\n              form.nomenclador = nomencladorID;\n              setPrestaciones([].concat(_toConsumableArray(_prestaciones), [_objectSpread(_objectSpread({}, form), {}, {\n                item: nomenclador === null || nomenclador === void 0 ? void 0 : nomenclador.data\n              })]));\n\n            case 25:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function addPrestacion() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var removePrestacion = function removePrestacion(id) {\n    setPrestaciones(_toConsumableArray(prestaciones.filter(function (_, index) {\n      return index !== id;\n    })));\n  };\n\n  var getStepContent = function getStepContent(step, formContent) {\n    switch (step) {\n      case 0:\n        return /*#__PURE__*/_jsxDEV(FormSolicitud, _objectSpread(_objectSpread({}, {\n          formContent: formContent\n        }), {}, {\n          step: STEPPER_SOLICITUDES.steps[step]\n        }), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 16\n        }, _this);\n\n      case 1:\n        return /*#__PURE__*/_jsxDEV(FormPrestaciones, _objectSpread(_objectSpread({}, {\n          formContent: formContent\n        }), {}, {\n          step: STEPPER_SOLICITUDES.steps[step],\n          addPrestacion: addPrestacion,\n          prestaciones: prestaciones,\n          removePrestacion: removePrestacion\n        }), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, _this);\n\n      case 2:\n        return /*#__PURE__*/_jsxDEV(SolicitudesSummary, {\n          solicitud: solicitud,\n          prestaciones: prestaciones,\n          header: true,\n          step: STEPPER_SOLICITUDES.steps[step],\n          form: compiledForm\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, _this);\n\n      case 3:\n        return /*#__PURE__*/_jsxDEV(FormAdjuntos, {\n          prestaciones: prestaciones,\n          step: STEPPER_SOLICITUDES.steps[step]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 16\n        }, _this);\n\n      default:\n        return 'Unknown step';\n    }\n  };\n\n  var handleNext = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var canContinue, result;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              canContinue = false;\n              setStepError(null);\n              _context2.next = 4;\n              return trigger();\n\n            case 4:\n              result = _context2.sent;\n\n              if (result) {\n                _context2.next = 7;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 7:\n              _context2.t0 = activeStep;\n              _context2.next = _context2.t0 === 0 ? 10 : _context2.t0 === 1 ? 14 : _context2.t0 === 2 ? 16 : _context2.t0 === 3 ? 21 : 23;\n              break;\n\n            case 10:\n              setCompiledForm(_objectSpread(_objectSpread({}, compiledForm), {}, {\n                solicitud: form\n              }));\n              setSolicitud(_objectSpread({}, form)); // if (!form.factura) {\n              //   return setStepError('No hay factura asociada');\n              // }\n\n              canContinue = true;\n              return _context2.abrupt(\"break\", 24);\n\n            case 14:\n              if ((prestaciones === null || prestaciones === void 0 ? void 0 : prestaciones.length) > 0) {\n                setCompiledForm(_objectSpread(_objectSpread({}, compiledForm), {}, {\n                  prestaciones: prestaciones\n                }));\n                canContinue = true;\n              } else {\n                setStepError('No hay prestaciones cargadas');\n              }\n\n              return _context2.abrupt(\"break\", 24);\n\n            case 16:\n              setCompiledForm(_objectSpread(_objectSpread({}, compiledForm), {}, {\n                three: form\n              }));\n              _context2.next = 19;\n              return handleSubmit(_objectSpread(_objectSpread({}, compiledForm), {}, {\n                three: form\n              }));\n\n            case 19:\n              canContinue = _context2.sent;\n              return _context2.abrupt(\"break\", 24);\n\n            case 21:\n              canContinue = true;\n              return _context2.abrupt(\"break\", 24);\n\n            case 23:\n              return _context2.abrupt(\"return\", 'not a valid step');\n\n            case 24:\n              if (canContinue) {\n                window.scrollTo(0, 0);\n                setActiveStep(function (prevActiveStep) {\n                  return prevActiveStep + 1;\n                });\n              }\n\n            case 25:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleNext() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleBack = function handleBack() {\n    if (activeStep > 0) {\n      setActiveStep(function (prevActiveStep) {\n        return prevActiveStep - 1;\n      });\n\n      switch (activeStep) {\n        case 1:\n          setCompiledForm(_objectSpread({}, compiledForm));\n          break;\n\n        case 2:\n          setCompiledForm(_objectSpread(_objectSpread({}, compiledForm), {}, {\n            prestaciones: form\n          }));\n          break;\n\n        default:\n          return 'not a valid step';\n      }\n    } else {\n      setShowStepper(false);\n    }\n  };\n\n  var handleReset = function handleReset() {\n    setActiveStep(0);\n    setCompiledForm({});\n    setPrestaciones(null);\n    setSolicitud(null);\n    setShowStepper(false);\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(form) {\n      var _form$solicitud, _form$solicitud2, _form$solicitud3, _form$solicitud$afili, date, _solicitud$data, _solicitud$data2, presAux, formData, resFactura, _solicitud;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!_.isEmpty(errors)) {\n                _context3.next = 26;\n                break;\n              }\n\n              setIsLoading(true);\n              date = typeof (form === null || form === void 0 ? void 0 : (_form$solicitud = form.solicitud) === null || _form$solicitud === void 0 ? void 0 : _form$solicitud.fechaAlta) === 'string' ? parseISO(form === null || form === void 0 ? void 0 : (_form$solicitud2 = form.solicitud) === null || _form$solicitud2 === void 0 ? void 0 : _form$solicitud2.fechaAlta) : form === null || form === void 0 ? void 0 : (_form$solicitud3 = form.solicitud) === null || _form$solicitud3 === void 0 ? void 0 : _form$solicitud3.fechaAlta;\n              form.solicitud.afiliado = ((_form$solicitud$afili = form.solicitud.afiliado) === null || _form$solicitud$afili === void 0 ? void 0 : _form$solicitud$afili.id) || form.solicitud.afiliado;\n              form.solicitud.estadoActual = 'sinPagos';\n              _context3.prev = 5;\n              //Remove the key used for show prestaciones list on step 2 before send to server\n              presAux = prestaciones.map(function (elem) {\n                var aux = _objectSpread(_objectSpread({}, elem), {}, {\n                  prestador: elem.prestador.id\n                });\n\n                delete aux.item;\n                return aux;\n              });\n              formData = new FormData();\n              formData.append('archivo', form.solicitud.factura[0]);\n              formData.append('etiqueta', '1');\n              _context3.next = 12;\n              return send({\n                url: 'api/facturas/',\n                data: formData,\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'multipart/form-data'\n                }\n              });\n\n            case 12:\n              resFactura = _context3.sent;\n              _context3.next = 15;\n              return post(SOLICITUDES.route, {\n                solicitud: _objectSpread(_objectSpread({}, form.solicitud), {}, {\n                  factura: resFactura.data.id\n                }),\n                prestaciones: presAux\n              });\n\n            case 15:\n              _solicitud = _context3.sent;\n              setIdSolicitud(_solicitud === null || _solicitud === void 0 ? void 0 : (_solicitud$data = _solicitud.data) === null || _solicitud$data === void 0 ? void 0 : _solicitud$data.id);\n              setPrestaciones(_toConsumableArray(_solicitud === null || _solicitud === void 0 ? void 0 : (_solicitud$data2 = _solicitud.data) === null || _solicitud$data2 === void 0 ? void 0 : _solicitud$data2.prestaciones.map(function (p) {\n                return _objectSpread(_objectSpread({}, p), {}, {\n                  item: p.nomenclador\n                });\n              })));\n              onFinished();\n              setIsLoading(false);\n              return _context3.abrupt(\"return\", true);\n\n            case 23:\n              _context3.prev = 23;\n              _context3.t0 = _context3[\"catch\"](5);\n              return _context3.abrupt(\"return\", false);\n\n            case 26:\n              return _context3.abrupt(\"return\", false);\n\n            case 27:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[5, 23]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Stepper, {\n      activeStep: activeStep,\n      children: steps.map(function (label, index) {\n        var stepProps = {};\n        var labelProps = {};\n        return /*#__PURE__*/_jsxDEV(Step, _objectSpread(_objectSpread({}, stepProps), {}, {\n          children: /*#__PURE__*/_jsxDEV(StepLabel, _objectSpread(_objectSpread({}, labelProps), {}, {\n            className: classes.stepLabel,\n            children: label\n          }), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, _this)\n        }), label, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 13\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Box, {\n      className: classes.formContainer,\n      children: activeStep === steps.length ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            style: {\n              margin: '15px 0'\n            },\n            children: [STEPPER_SOLICITUDES.end, \" \", idSolicitud]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(Typography, {\n            children: STEPPER_SOLICITUDES.end2\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              marginTop: 35\n            },\n            onClick: handleReset,\n            color: \"primary\",\n            variant: \"contained\",\n            children: STEPPER_SOLICITUDES.close\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [getStepContent(activeStep, compiledForm), /*#__PURE__*/_jsxDEV(Box, {\n          className: classes.stepperButtons,\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleBack,\n            className: classes.button,\n            color: \"secondary\",\n            variant: \"contained\",\n            children: activeStep === 0 ? STEPPER_SOLICITUDES.cancel : STEPPER_SOLICITUDES.back\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            className: classes.buttonNext,\n            color: \"primary\",\n            onClick: handleNext,\n            children: activeStep === steps.length - 1 ? STEPPER_SOLICITUDES.finish : STEPPER_SOLICITUDES.next\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Loading, {\n      loading: isLoading,\n      message: 'Guardando solicitud...'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Alert, {\n      open: !!stepError,\n      severity: 'error',\n      message: stepError,\n      autoHideAfter: 5500,\n      onClose: function onClose() {\n        setStepError(null);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(FormStepper, \"QEXWWWqMZ3EipyA7zm++3MFzhnw=\", false, function () {\n  return [useFormContext, useStyles];\n});\n\n_c = FormStepper;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormStepper\");","map":{"version":3,"sources":["/reintegros/reintegros-frontend/components/solicitudes/Stepper.tsx"],"names":["React","useFormContext","Stepper","Step","StepLabel","Button","_","Typography","format","parseISO","get","post","send","NOMENCLADOR","PRESTADORES","SOLICITUDES","STEPPER_SOLICITUDES","useStyles","Box","FormSolicitud","FormPrestaciones","FormAdjuntos","SolicitudesSummary","Alert","Loading","FormStepper","setShowStepper","onFinished","watch","errors","trigger","setError","useState","activeStep","setActiveStep","compiledForm","setCompiledForm","steps","map","elem","title","form","prestaciones","setPrestaciones","solicitud","setSolicitud","stepError","setStepError","isLoading","setIsLoading","idSolicitud","setIdSolicitud","classes","addPrestacion","fechaPractica","fechaPracticaHasta","cobertura","parseInt","_prestaciones","capitulo","p","console","log","prestadorID","prestador","value","route","data","nomencladorID","nomenclador","item","removePrestacion","id","filter","index","getStepContent","step","formContent","handleNext","canContinue","result","length","three","handleSubmit","window","scrollTo","prevActiveStep","handleBack","handleReset","isEmpty","date","fechaAlta","afiliado","estadoActual","presAux","aux","formData","FormData","append","factura","url","method","headers","resFactura","label","stepProps","labelProps","stepLabel","formContainer","textAlign","margin","end","end2","marginTop","close","stepperButtons","button","cancel","back","buttonNext","finish","next"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport Button from '@material-ui/core/Button';\nimport _ from 'lodash';\nimport Typography from '@material-ui/core/Typography';\nimport { format, parseISO } from 'date-fns';\nimport { get, post, send } from '../api-call/service';\nimport { NOMENCLADOR, PRESTADORES, SOLICITUDES, STEPPER_SOLICITUDES } from '../../labels';\nimport useStyles from './Stepper.styles';\nimport { Box } from '@material-ui/core';\nimport { FormSolicitud } from './FormSolicitud';\nimport { FormPrestaciones } from './prestaciones/FormPrestaciones';\nimport { FormAdjuntos } from './adjuntos/FormAdjuntos';\nimport SolicitudesSummary from './SolicitudesSummary';\nimport Alert from '../common/Alert';\nimport Loading from '../common/Loading';\n\nexport const FormStepper = ({ setShowStepper, onFinished }) => {\n  const { watch, errors, trigger, setError } = useFormContext();\n  const [activeStep, setActiveStep] = React.useState(0);\n  const [compiledForm, setCompiledForm] = React.useState({});\n  const steps = STEPPER_SOLICITUDES.steps.map((elem) => elem.title);\n  const form = watch();\n  const [prestaciones, setPrestaciones] = React.useState([]);\n  const [solicitud, setSolicitud] = React.useState(null);\n  const [stepError, setStepError] = React.useState(null);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [idSolicitud, setIdSolicitud] = React.useState(null);\n\n  const classes = useStyles();\n\n  const addPrestacion = async () => {\n    form.fechaPractica = format(form?.fechaPractica, 'yyyy-MM-dd');\n    if (form?.fechaPracticaHasta) {\n      form.fechaPracticaHasta = format(form?.fechaPracticaHasta, 'yyyy-MM-dd');\n    }\n    form.cobertura = parseInt(form.cobertura);\n\n    let _prestaciones = prestaciones;\n    if (form.capitulo === 40 || form.capitulo === 41 || form.capitulo === 43) {\n      _prestaciones = _prestaciones.map((p) => {\n        console.log({ p });\n        if (p.capitulo !== 40 && p.capitulo !== 41 && p.capitulo !== 43) {\n          p.cobertura = 100;\n        } else {\n          p.cobertura = 90;\n        }\n        return p;\n      });\n    }\n    const prestadorID = form.prestador?.value || form.prestador;\n    form.prestador = (await get(`${PRESTADORES.route}/${prestadorID}/`))?.data;\n    const nomencladorID = form.nomenclador?.value || form.nomenclador;\n    const nomenclador = await get(`${NOMENCLADOR.route}/${nomencladorID}/`);\n    form.capitulo = form.capitulo?.value || form.capitulo;\n    form.nomenclador = nomencladorID;\n\n    setPrestaciones([..._prestaciones, { ...form, item: nomenclador?.data }]);\n  };\n\n  const removePrestacion = (id) => {\n    setPrestaciones([...prestaciones.filter((_, index) => index !== id)]);\n  };\n\n  const getStepContent = (step, formContent) => {\n    switch (step) {\n      case 0:\n        return <FormSolicitud {...{ formContent }} step={STEPPER_SOLICITUDES.steps[step]} />;\n      case 1:\n        return (\n          <FormPrestaciones\n            {...{ formContent }}\n            step={STEPPER_SOLICITUDES.steps[step]}\n            addPrestacion={addPrestacion}\n            prestaciones={prestaciones}\n            removePrestacion={removePrestacion}\n          />\n        );\n      case 2:\n        return (\n          <SolicitudesSummary\n            solicitud={solicitud}\n            prestaciones={prestaciones}\n            header={true}\n            step={STEPPER_SOLICITUDES.steps[step]}\n            form={compiledForm}\n          />\n        );\n      case 3:\n        return <FormAdjuntos prestaciones={prestaciones} step={STEPPER_SOLICITUDES.steps[step]} />;\n\n      default:\n        return 'Unknown step';\n    }\n  };\n\n  const handleNext = async () => {\n    let canContinue = false;\n    setStepError(null);\n\n    const result = await trigger();\n    if (!result) {\n      return;\n    }\n\n    switch (activeStep) {\n      case 0:\n        setCompiledForm({ ...compiledForm, solicitud: form });\n        setSolicitud({ ...form });\n        // if (!form.factura) {\n        //   return setStepError('No hay factura asociada');\n        // }\n        canContinue = true;\n        break;\n      case 1:\n        if (prestaciones?.length > 0) {\n          setCompiledForm({ ...compiledForm, prestaciones: prestaciones });\n          canContinue = true;\n        } else {\n          setStepError('No hay prestaciones cargadas');\n        }\n        break;\n      case 2:\n        setCompiledForm({ ...compiledForm, three: form });\n        canContinue = await handleSubmit({ ...compiledForm, three: form });\n        break;\n      case 3:\n        canContinue = true;\n        break;\n      default:\n        return 'not a valid step';\n    }\n    if (canContinue) {\n      window.scrollTo(0, 0);\n      setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    }\n  };\n\n  const handleBack = () => {\n    if (activeStep > 0) {\n      setActiveStep((prevActiveStep) => prevActiveStep - 1);\n      switch (activeStep) {\n        case 1:\n          setCompiledForm({ ...compiledForm });\n          break;\n        case 2:\n          setCompiledForm({ ...compiledForm, prestaciones: form });\n          break;\n        default:\n          return 'not a valid step';\n      }\n    } else {\n      setShowStepper(false);\n    }\n  };\n\n  const handleReset = () => {\n    setActiveStep(0);\n    setCompiledForm({});\n    setPrestaciones(null);\n    setSolicitud(null);\n    setShowStepper(false);\n  };\n\n  const handleSubmit = async (form) => {\n    if (_.isEmpty(errors)) {\n      setIsLoading(true);\n      const date =\n        typeof form?.solicitud?.fechaAlta === 'string'\n          ? parseISO(form?.solicitud?.fechaAlta)\n          : form?.solicitud?.fechaAlta;\n      form.solicitud.afiliado = form.solicitud.afiliado?.id || form.solicitud.afiliado;\n      form.solicitud.estadoActual = 'sinPagos';\n      try {\n        //Remove the key used for show prestaciones list on step 2 before send to server\n        const presAux = prestaciones.map((elem) => {\n          const aux = { ...elem, prestador: elem.prestador.id };\n          delete aux.item;\n          return aux;\n        });\n\n        const formData = new FormData();\n        formData.append('archivo', form.solicitud.factura[0]);\n        formData.append('etiqueta', '1');\n\n        const resFactura = await send({\n          url: 'api/facturas/',\n          data: formData,\n          method: 'POST',\n          headers: {\n            'Content-Type': 'multipart/form-data',\n          },\n        });\n\n        const solicitud = await post(SOLICITUDES.route, {\n          solicitud: { ...form.solicitud, factura: resFactura.data.id },\n          prestaciones: presAux,\n        });\n\n        setIdSolicitud(solicitud?.data?.id);\n\n        setPrestaciones([\n          ...solicitud?.data?.prestaciones.map((p) => ({ ...p, item: p.nomenclador })),\n        ]);\n        onFinished();\n        setIsLoading(false);\n        return true;\n      } catch (error) {\n        return false;\n      }\n    }\n    return false;\n  };\n\n  return (\n    <>\n      <Stepper activeStep={activeStep}>\n        {steps.map((label, index) => {\n          const stepProps = {};\n          const labelProps = {};\n          return (\n            <Step key={label} {...stepProps}>\n              <StepLabel {...labelProps} className={classes.stepLabel}>\n                {label}\n              </StepLabel>\n            </Step>\n          );\n        })}\n      </Stepper>\n      <Box className={classes.formContainer}>\n        {activeStep === steps.length ? (\n          <>\n            <div style={{ textAlign: 'center' }}>\n              <Typography style={{ margin: '15px 0' }}>\n                {STEPPER_SOLICITUDES.end} {idSolicitud}\n              </Typography>\n              <Typography>{STEPPER_SOLICITUDES.end2}</Typography>\n              <Button\n                style={{ marginTop: 35 }}\n                onClick={handleReset}\n                color=\"primary\"\n                variant=\"contained\"\n              >\n                {STEPPER_SOLICITUDES.close}\n              </Button>\n            </div>\n          </>\n        ) : (\n          <>\n            {getStepContent(activeStep, compiledForm)}\n            <Box className={classes.stepperButtons}>\n              <Button\n                onClick={handleBack}\n                className={classes.button}\n                color=\"secondary\"\n                variant=\"contained\"\n              >\n                {activeStep === 0 ? STEPPER_SOLICITUDES.cancel : STEPPER_SOLICITUDES.back}\n              </Button>\n              <Button\n                variant=\"contained\"\n                className={classes.buttonNext}\n                color=\"primary\"\n                onClick={handleNext}\n              >\n                {activeStep === steps.length - 1\n                  ? STEPPER_SOLICITUDES.finish\n                  : STEPPER_SOLICITUDES.next}\n              </Button>\n            </Box>\n          </>\n        )}\n      </Box>\n      <Loading loading={isLoading} message={'Guardando solicitud...'} />\n      <Alert\n        open={!!stepError}\n        severity={'error'}\n        message={stepError}\n        autoHideAfter={5500}\n        onClose={() => {\n          setStepError(null);\n        }}\n      />\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}