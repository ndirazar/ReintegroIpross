{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState } from 'react';\nimport { FieldType } from '../builder/FormField';\nimport { SOLICITUDES } from '../../labels';\nimport { Grid, Typography, makeStyles } from '@material-ui/core';\nimport FieldRender from '../builder/FieldRender';\nimport { send } from '../api-call/service';\nconst useStyles = makeStyles(theme => ({\n  afiliadoField: {\n    display: 'None'\n  },\n  afiliadoSearch: {\n    paddingLeft: '10px'\n  },\n  afiliadoDetail: {\n    paddingTop: '15px',\n    '& h6': {\n      fontSize: '14px'\n    }\n  }\n}));\nexport default function Afiliados({\n  form,\n  onSelect\n}) {\n  const {\n    0: afiliadoError,\n    1: setAfiliadoError\n  } = useState(null);\n  const {\n    0: afiliado,\n    1: setAfiliado\n  } = useState(null);\n  const classes = useStyles();\n\n  const showAfiliado = () => {\n    return afiliadoError ? /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(Typography, {\n        component: \"h6\",\n        color: \"error\",\n        children: afiliadoError\n      })\n    }) : afiliado && /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsxs(Typography, {\n        component: \"h6\",\n        children: [/*#__PURE__*/_jsx(\"strong\", {\n          children: \"Nombre: \"\n        }), \" \", afiliado.nombre, \" \", afiliado.apellido]\n      }), /*#__PURE__*/_jsxs(Typography, {\n        component: \"h6\",\n        children: [/*#__PURE__*/_jsx(\"strong\", {\n          children: \"Cuit/Cuil: \"\n        }), afiliado.cuitCuil, /*#__PURE__*/_jsx(\"strong\", {\n          children: \" Cbu: \"\n        }), afiliado.cbu, /*#__PURE__*/_jsx(\"strong\", {\n          children: \" Cuenta judicial: \"\n        }), afiliado.cuentajudicial ? 'si' : 'no']\n      })]\n    });\n  };\n\n  const searchConfig = {\n    name: 'numeroAfiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    onChange: async (value, f) => {\n      const regex = /^[0-9]{2}-[0-9]{8}\\/[0-9]{2}$/;\n      const isValid = value.match(regex);\n      setAfiliadoError(null);\n\n      if (isValid) {\n        try {\n          const val = await send({\n            url: `api/verificar/afiliado`,\n            data: {\n              afiliado: value\n            },\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          });\n\n          if (val.data.afiliado) {\n            form.setValue('afiliado', val.data.afiliado);\n            setAfiliado(val.data.afiliado);\n            onSelect(val.data.afiliado);\n          } else {\n            setAfiliado(null);\n            setAfiliadoError('Un error');\n          }\n        } catch (error) {\n          var _error$response, _error$response$data;\n\n          console.log(error);\n          setAfiliado(null);\n\n          if ((_error$response = error.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n            setAfiliadoError(error.response.data.message);\n          } else {\n            setAfiliadoError('Error consultando afiliado');\n          }\n        }\n      } else {\n        setAfiliado(null);\n      }\n    },\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    }\n  };\n  const afiliadoField = {\n    name: 'afiliado',\n    type: FieldType.string,\n    label: SOLICITUDES.fields['afiliado'],\n    styling: {\n      columns: 3\n    },\n    rules: {\n      required: true\n    },\n    disable: true\n  };\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsx(Grid, {\n        item: true,\n        md: 3,\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: classes.afiliadoSearch,\n          children: /*#__PURE__*/_jsx(FieldRender, {\n            field: searchConfig,\n            form: form,\n            data: []\n          })\n        })\n      }), /*#__PURE__*/_jsxs(Grid, {\n        item: true,\n        md: 9,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: classes.afiliadoField,\n          children: /*#__PURE__*/_jsx(FieldRender, {\n            field: afiliadoField,\n            form: form,\n            data: []\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: classes.afiliadoDetail,\n          children: showAfiliado()\n        })]\n      })]\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}