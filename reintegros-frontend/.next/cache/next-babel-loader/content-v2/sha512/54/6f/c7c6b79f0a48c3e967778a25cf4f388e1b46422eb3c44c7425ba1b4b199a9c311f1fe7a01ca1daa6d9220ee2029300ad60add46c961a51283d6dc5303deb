{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from 'react';\nimport { Box, Container, Grid, IconButton, Link, makeStyles, Typography } from '@material-ui/core';\nimport ReceiptIcon from '@material-ui/icons/Receipt';\nimport { ACTIONS, PRESTACIONES, SOLICITUDES } from '../../labels';\nimport { send } from '../api-call/service';\nimport Modal from '../common/Modal';\nimport Table from '../common/Table';\nimport { Edit } from '@material-ui/icons';\nimport { getUser } from '../common/helpers';\nconst useStyles = makeStyles(theme => ({\n  detail: {\n    backgroundColor: '#eae8e8',\n    paddingBottom: '15px'\n  },\n  container: {\n    margin: '0 15px',\n    width: '100%',\n    maxWidth: '100%'\n  }\n}));\nexport default function SolicitudesSummary({\n  solicitud,\n  prestaciones,\n  header,\n  step,\n  onEditPrestacion\n}) {\n  var _solicitud$afiliado2, _SOLICITUDES$optionsT, _solicitud$afiliado3;\n\n  const {\n    0: factura,\n    1: setFactura\n  } = useState(null);\n  const {\n    0: delegacion,\n    1: setDelegacion\n  } = useState('');\n  const {\n    0: estadoActual,\n    1: setEstadoActual\n  } = useState('');\n  const {\n    0: currentPrestaciones,\n    1: setCurrentPrestaciones\n  } = useState(prestaciones);\n  const classes = useStyles();\n  const filesUrl = process.env.NEXT_PUBLIC_API.substring(0, process.env.NEXT_PUBLIC_API.length - 1);\n  const {\n    0: editPrestacion,\n    1: setEditPrestacion\n  } = useState(null);\n  const user = getUser();\n  const renders = {\n    factura: rowData => {\n      var _rowData$solicitud, _rowData$solicitud$fa;\n\n      if (rowData !== null && rowData !== void 0 && (_rowData$solicitud = rowData.solicitud) !== null && _rowData$solicitud !== void 0 && (_rowData$solicitud$fa = _rowData$solicitud.factura) !== null && _rowData$solicitud$fa !== void 0 && _rowData$solicitud$fa.archivo) {\n        var _rowData$solicitud2, _rowData$solicitud2$f;\n\n        return /*#__PURE__*/_jsx(Link, {\n          href: `${filesUrl}${rowData === null || rowData === void 0 ? void 0 : (_rowData$solicitud2 = rowData.solicitud) === null || _rowData$solicitud2 === void 0 ? void 0 : (_rowData$solicitud2$f = _rowData$solicitud2.factura) === null || _rowData$solicitud2$f === void 0 ? void 0 : _rowData$solicitud2$f.archivo}`,\n          target: \"_blank\",\n          children: /*#__PURE__*/_jsx(IconButton, {\n            color: \"primary\",\n            \"aria-label\": \"factura\",\n            component: \"span\",\n            children: /*#__PURE__*/_jsx(ReceiptIcon, {})\n          })\n        });\n      }\n\n      return /*#__PURE__*/_jsx(IconButton, {\n        color: \"primary\",\n        \"aria-label\": \"factura\",\n        component: \"span\",\n        onClick: async () => {\n          var _rowData$solicitud3, _rowData$solicitud4, _rowData$solicitud4$f, _rowData$solicitud5, _rowData$solicitud6, _rowData$solicitud6$f, _resFactura$data$type, _resFactura$data;\n\n          const facturaId = typeof (rowData === null || rowData === void 0 ? void 0 : (_rowData$solicitud3 = rowData.solicitud) === null || _rowData$solicitud3 === void 0 ? void 0 : _rowData$solicitud3.factura) === 'object' ? rowData === null || rowData === void 0 ? void 0 : (_rowData$solicitud4 = rowData.solicitud) === null || _rowData$solicitud4 === void 0 ? void 0 : (_rowData$solicitud4$f = _rowData$solicitud4.factura) === null || _rowData$solicitud4$f === void 0 ? void 0 : _rowData$solicitud4$f.id : rowData === null || rowData === void 0 ? void 0 : (_rowData$solicitud5 = rowData.solicitud) === null || _rowData$solicitud5 === void 0 ? void 0 : _rowData$solicitud5.factura;\n\n          if (facturaId === null) {\n            return false;\n          }\n\n          const resFactura = await send({\n            url: `api/facturas/${facturaId}`,\n            method: 'GET',\n            responseType: 'blob' // Important\n\n          });\n          let file_name = `api/facturas_${facturaId}`;\n\n          if (rowData !== null && rowData !== void 0 && (_rowData$solicitud6 = rowData.solicitud) !== null && _rowData$solicitud6 !== void 0 && (_rowData$solicitud6$f = _rowData$solicitud6.factura) !== null && _rowData$solicitud6$f !== void 0 && _rowData$solicitud6$f.archivo) {\n            var _rowData$solicitud7, _rowData$solicitud7$f, _rowData$solicitud7$f2;\n\n            const path_file = rowData === null || rowData === void 0 ? void 0 : (_rowData$solicitud7 = rowData.solicitud) === null || _rowData$solicitud7 === void 0 ? void 0 : (_rowData$solicitud7$f = _rowData$solicitud7.factura) === null || _rowData$solicitud7$f === void 0 ? void 0 : (_rowData$solicitud7$f2 = _rowData$solicitud7$f.archivo) === null || _rowData$solicitud7$f2 === void 0 ? void 0 : _rowData$solicitud7$f2.split('/');\n            file_name = path_file[path_file.length - 1];\n          }\n\n          const element = document.createElement('a');\n          const file = new Blob([resFactura.data], {\n            type: (_resFactura$data$type = resFactura === null || resFactura === void 0 ? void 0 : (_resFactura$data = resFactura.data) === null || _resFactura$data === void 0 ? void 0 : _resFactura$data.type) !== null && _resFactura$data$type !== void 0 ? _resFactura$data$type : 'text/plain'\n          });\n          element.href = URL.createObjectURL(file);\n          element.download = '';\n          document.body.appendChild(element);\n          element.click();\n        },\n        children: /*#__PURE__*/_jsx(ReceiptIcon, {})\n      });\n    },\n    adjuntos: rowData => {\n      var _rowData$adjuntos;\n\n      return (_rowData$adjuntos = rowData.adjuntos) === null || _rowData$adjuntos === void 0 ? void 0 : _rowData$adjuntos.map((adj, i) => {\n        return /*#__PURE__*/_jsx(Link, {\n          href: `${filesUrl}${adj.archivo}`,\n          target: \"_blank\",\n          children: /*#__PURE__*/_jsx(IconButton, {\n            color: \"primary\",\n            \"aria-label\": \"factura\",\n            component: \"span\",\n            children: /*#__PURE__*/_jsx(ReceiptIcon, {})\n          })\n        });\n      });\n    },\n    cud: rowData => {\n      var _solicitud$afiliado;\n\n      return (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'true' ? solicitud === null || solicitud === void 0 ? void 0 : (_solicitud$afiliado = solicitud.afiliado) === null || _solicitud$afiliado === void 0 ? void 0 : _solicitud$afiliado.cud : '';\n    },\n    discapacitado: rowData => (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'true' ? 'Si' : 'No'\n  };\n  useEffect(() => {\n    var _user$delegaciones;\n\n    const del = user === null || user === void 0 ? void 0 : (_user$delegaciones = user.delegaciones) === null || _user$delegaciones === void 0 ? void 0 : _user$delegaciones.find(d => d.id === (solicitud === null || solicitud === void 0 ? void 0 : solicitud.delegacion));\n    setDelegacion(del === null || del === void 0 ? void 0 : del.nombre);\n    const estado = SOLICITUDES.optionsEstadoActual.find(e => e.value === (solicitud === null || solicitud === void 0 ? void 0 : solicitud.estadoActual));\n    setEstadoActual(estado === null || estado === void 0 ? void 0 : estado.label);\n  }, [solicitud]);\n\n  const handleEditPrestacion = rowData => {\n    onEditPrestacion && onEditPrestacion(rowData);\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: classes.detail,\n    children: [/*#__PURE__*/_jsxs(Container, {\n      className: classes.container,\n      children: [solicitud && header && /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsxs(Box, {\n          children: [/*#__PURE__*/_jsx(Typography, {\n            variant: \"h5\",\n            gutterBottom: true,\n            children: step.title\n          }), /*#__PURE__*/_jsx(Typography, {\n            variant: \"subtitle1\",\n            gutterBottom: true,\n            children: step.description\n          })]\n        }), /*#__PURE__*/_jsxs(Grid, {\n          container: true,\n          spacing: 3,\n          children: [/*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields['delegacion.nombre']\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: delegacion\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields['afiliado.codigo']\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: (_solicitud$afiliado2 = solicitud.afiliado) === null || _solicitud$afiliado2 === void 0 ? void 0 : _solicitud$afiliado2.codigo\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.estadoActual\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: estadoActual\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.fechaAlta\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: solicitud.fechaAlta\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.tipo\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: (_SOLICITUDES$optionsT = SOLICITUDES.optionsType.find(e => e.value === (solicitud === null || solicitud === void 0 ? void 0 : solicitud.tipo))) === null || _SOLICITUDES$optionsT === void 0 ? void 0 : _SOLICITUDES$optionsT.label\n            })]\n          }), /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 2,\n            children: [/*#__PURE__*/_jsx(Typography, {\n              color: \"textSecondary\",\n              variant: \"overline\",\n              display: \"block\",\n              gutterBottom: true,\n              children: SOLICITUDES.fields.discapacitado\n            }), /*#__PURE__*/_jsx(Typography, {\n              color: \"textPrimary\",\n              variant: \"body1\",\n              display: \"block\",\n              gutterBottom: true,\n              children: (solicitud === null || solicitud === void 0 ? void 0 : solicitud.discapacitado) === 'true' ? `Si - ${solicitud === null || solicitud === void 0 ? void 0 : (_solicitud$afiliado3 = solicitud.afiliado) === null || _solicitud$afiliado3 === void 0 ? void 0 : _solicitud$afiliado3.cud}` : 'No'\n            })]\n          })]\n        })]\n      }), currentPrestaciones && /*#__PURE__*/_jsx(Table, {\n        columns: Object.keys(PRESTACIONES.fields).map(key => {\n          var _ref, _renders$key;\n\n          return {\n            title: PRESTACIONES.fields[key],\n            field: key,\n            render: (_ref = (_renders$key = renders[key]) !== null && _renders$key !== void 0 ? _renders$key : PRESTACIONES.renders[key]) !== null && _ref !== void 0 ? _ref : null\n          };\n        }),\n        totalCount: currentPrestaciones.length,\n        data: currentPrestaciones,\n        title: PRESTACIONES.name,\n        options: {\n          search: false\n        },\n        pageSize: currentPrestaciones.length,\n        paging: false,\n        actions: [{\n          icon: () => /*#__PURE__*/_jsx(Edit, {}),\n          tooltip: ACTIONS.update(SOLICITUDES.editPrestaciones),\n          onClick: (event, rowData) => {\n            if (rowData.auditoria) {\n              return false;\n            }\n\n            handleEditPrestacion(rowData);\n          }\n        }]\n      })]\n    }), factura && /*#__PURE__*/_jsx(Modal, {\n      customClasses: {},\n      open: true,\n      onClose: () => setFactura(null),\n      title: 'factura',\n      breadcrumbs: '',\n      subTitle: false,\n      actions: false,\n      onAcept: null,\n      onCancel: null,\n      maxWidth: 'sm',\n      children: /*#__PURE__*/_jsx(\"img\", {\n        src: factura,\n        alt: \"Factura\",\n        width: 500\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}